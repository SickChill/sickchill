function getMeta(e){return $('meta[data-var="'+e+'"]').data("content")}const scRoot=getMeta("scRoot"),scDefaultPage=getMeta("scDefaultPage"),themeSpinner=getMeta("themeSpinner"),anonURL=getMeta("anonURL"),topImageHtml='<img src="'+scRoot+'/images/top.gif" width="31" height="11" alt="Jump to top" />',loading='<img src="'+scRoot+"/images/loading16"+themeSpinner+'.gif" height="16" width="16" />';let srPID=getMeta("srPID");function configSuccess(){$(".config_submitter").each(function(){$(this).removeAttr("disabled"),$(this).next().remove(),$(this).show()}),$(".config_submitter_refresh").each(function(){$(this).removeAttr("disabled"),$(this).next().remove(),$(this).show(),window.location.href=scRoot+"/config/providers/"}),$("#email_show").trigger("notify"),$("#prowl_show").trigger("notify")}function metaToBool(e){let t=$('meta[data-var="'+e+'"]').data("content");return t===void 0?(console.log(e+" is empty, did you forget to add this to main.mako?"),t):(t=Number.isNaN(t)?t.toLowerCase():t.toString(),t=t.toLowerCase(),!(t==="false"||t==="none"||t==="0"))}function isMeta(e,t){const n=new RegExp(t.length>1?t.join("|"):t);return n.test($('meta[data-var="'+e+'"]').data("content"))}function notifyModal(e){$("#site-notification-modal .modal-body").html(e),$("#site-notification-modal").modal()}function addSiteMessage(e="danger",t="",n=""){$.post(scRoot+"/ui/set_site_message",{level:e,tag:t,message:n},e=>{const t=$("#site-messages");if(t!==void 0){t.empty();for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.append('<div class="alert alert-'+e[n].level+' upgrade-notification hidden-print" id="site-message-'+n+'" role="alert"><span>'+e[n].message+'</span><span class="glyphicon glyphicon-check site-message-dismiss pull-right" data-id="'+n+'"/></div>')}}),$("#site-messages").on("click",".site-message-dismiss",function(){const e=$(this).data("id");$("#site-message-"+e).hide(),$.post(scRoot+"/ui/dismiss-site-message",{index:e})})}function shiftReturn(e){return e.length<=1?[]:(e.shift(),e)}const __=_;window._=function(e){return e};const SICKCHILL={common:{init(){(function(){const e=document.querySelectorAll("img");for(const t of e)t.dataset.src&&t.setAttribute("src",t.dataset.src);metaToBool("settings.SICKCHILL_BACKGROUND")&&($.backstretch(scRoot+"/ui/sickchill_background"),$(".backstretch").css("opacity",getMeta("settings.FANART_BACKGROUND_OPACITY")).fadeIn("500"))})(),addSiteMessage(),$.confirm.options={confirmButton:"Yes",cancelButton:"Cancel",dialogClass:"modal-dialog",post:!1,confirm(e){location.href=e.context.href}},$("a.shutdown").confirm({title:"Shutdown",text:"Are you sure you want to shutdown SickChill?"}),$("a.restart").confirm({title:"Restart",text:"Are you sure you want to restart SickChill?"}),$("a.removeshow").confirm({title:"Remove Show",text:'Are you sure you want to remove <span class="footerhighlight">'+$("#showtitle").data("showname")+'</span> from the database?<br><br><input type="checkbox" id="deleteFiles" name="deleteFiles"/>&nbsp;<label for="deleteFiles" class="red-text">Check to delete files as well. IRREVERSIBLE</label>',confirm(e){location.href=e.context.href+($("#deleteFiles")[0].checked?"&full=1":"")}}),$("a.clearhistory").confirm({title:"Clear History",text:"Are you sure you want to clear all download history?"}),$("a.trimhistory").confirm({title:"Trim History",text:"Are you sure you want to trim all download history older than 30 days?"}),$("a.submiterrors").confirm({title:"Submit Errors",text:'Are you sure you want to submit these errors ?<br><br><span class="red-text">Make sure SickChill is updated and trigger<br> this error with debug enabled before submitting</span>'}),$("#config-components").tabs({activate(e,t){let n=$(this).data("lastOpenedPanel");n||(n=$(t.oldPanel)),$(this).data("topPositionTab")||$(this).data("topPositionTab",$(t.newPanel).position().top),$(t.newPanel).hide().fadeIn(0),n&&n.toggleClass("ui-tabs-hide").css("position","absolute").css("top",$(this).data("topPositionTab")+"px").fadeOut(0,function(){$(this).css("position","")}),$(this).data("lastOpenedPanel",$(t.newPanel))}}),(navigator.maxTouchPoints||0)<2&&$(".dropdown-toggle").on("click",function(){const e=$(this);e.attr("aria-expanded")==="true"&&(window.location.href=e.attr("href"))}),metaToBool("settings.FUZZY_DATING")&&($.timeago.settings.allowFuture=!0,$.timeago.settings.strings={prefixAgo:null,prefixFromNow:"In ",suffixAgo:"ago",suffixFromNow:"",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"an hour",hours:"%d hours",day:"a day",days:"%d days",month:"a month",months:"%d months",year:"a year",years:"%d years",wordSeparator:" ",numbers:[]},$("[datetime]").timeago()),$(document.body).on("click","a[data-no-redirect]",e=>{const t=$(e.currentTarget).preventDefault();return $.get(t.attr("href")),!1}),$(document.body).on("click",".bulkCheck",e=>{const t=$(e.currentTarget),n=t.attr("id");$("."+n+":visible").each(function(){$(this).prop("checked",t.is(":checked"))})}),$(".enabler").each(function(){$(this).is(":checked")||$("#content_"+$(this).attr("id")).hide()}),$(".enabler").on("change",function(){$(this).is(":checked")?$("#content_"+$(this).attr("id")).fadeIn("fast","linear"):$("#content_"+$(this).attr("id")).fadeOut("fast","linear")})},QualityChooser:{setFromPresets(e){if(Number.parseInt(e,10)===0){$("#customQuality").show();return}$("#customQuality").hide(),$("#anyQualities").find("option").each(function(){const t=e&$(this).val();$(this).attr("selected",t>0&&"selected")}),$("#bestQualities").find("option").each(function(){const t=e&$(this).val()<<16;$(this).attr("selected",t>0&&"selected")})},init(){const e=$("#qualityPreset");e.on("change",()=>{this.setFromPresets(e.find(":selected").val())}),this.setFromPresets(e.find(":selected").val())}},updateBlackWhiteList(e){$("#pool").children().remove(),$("#anime").is(":checked")?($("#blackwhitelist").show(),e&&$.getJSON(scRoot+"/home/fetch_releasegroups",{show_name:e},e=>{e.result==="success"&&$.each(e.groups,(e,t)=>{const n=$("<option>");n.attr("value",t.name),n.html(t.name+" | "+t.rating+" | "+t.range),n.appendTo("#pool")})})):$("#blackwhitelist").hide()}},config:{init(){$("#config-components").tabs(),$(".viewIf").on("click",function(){$(this).is(":checked")?($(".hide_if_"+$(this).attr("id")).css("display","none"),$(".show_if_"+$(this).attr("id")).fadeIn("fast","linear")):($(".show_if_"+$(this).attr("id")).css("display","none"),$(".hide_if_"+$(this).attr("id")).fadeIn("fast","linear"))}),$(".datePresets").on("click",function(){let e=$("#date_presets").val();$(this).is(":checked")&&e==="%x"?(e="%a, %b %d, %Y",$("#date_use_system_default").html("1")):!$(this).is(":checked")&&$("#date_use_system_default").html()==="1"&&(e="%x"),$("#date_presets").attr("name","date_preset_old"),$("#date_presets").attr("id","date_presets_old"),$("#date_presets_na").attr("name","date_preset"),$("#date_presets_na").attr("id","date_presets"),$("#date_presets_old").attr("name","date_preset_na"),$("#date_presets_old").attr("id","date_presets_na"),e&&$("#date_presets").val(e)}),$("#configForm").ajaxForm({beforeSubmit(){$(".config_submitter .config_submitter_refresh").each(function(){$(this).attr("disabled","disabled"),$(this).after('<span><img src="'+scRoot+"/images/loading16"+themeSpinner+'.gif"> Saving...</span>'),$(this).hide()})},success(){setTimeout(configSuccess,2e3)}}),$("#api_key").on("click",()=>{$("#api_key").select()}),$("#generate_new_apikey").on("click",()=>{$.get(scRoot+"/config/general/generateApiKey",e=>{if(e.error!==void 0){notifyModal(e.error);return}$("#api_key").val(e)})}),$("#git_token").on("click",$("#git_token").select()),$("#create_access_token").on("click",()=>{notifyModal('<p>Copy the generated token and paste it in the token input box.</p><p>Provide permissions for repo:status, public_repo, write:discussion, read:discussion, user, gist, and notifications</p><p><a href="'+anonURL+'https://github.com/settings/tokens/new?description=SickChill&scopes=user,gist,public_repo" target="_blank"><input class="btn" type="button" value="Continue to Github..."></a></p>'),$("#git_token").select()}),$("#manage_tokens").on("click",()=>{window.open(anonURL+"https://github.com/settings/tokens","_blank")})},index(){$("#log_dir").fileBrowser({title:_("Select log file folder location")}),$("#sickchill_background_path").fileBrowser({title:_("Select Background Image"),key:"sickchill_background_path",includeFiles:1,fileTypes:["images"]}),$("#custom_css_path").fileBrowser({title:_("Select CSS file"),key:"custom_css_path",includeFiles:1,fileTypes:["css"]})},backupRestore(){$("#Backup").on("click",()=>{$("#Backup").attr("disabled",!0),$("#Backup-result").html(loading);const e=$("#backupDir").val();$.get(scRoot+"/config/backuprestore/backup",{backupDir:e}).done(e=>{$("#Backup-result").html(e),$("#Backup").attr("disabled",!1)})}),$("#Restore").on("click",()=>{$("#Restore").attr("disabled",!0),$("#Restore-result").html(loading);const e=$("#backupFile").val();$.post(scRoot+"/config/backuprestore/restore",{backupFile:e}).done(e=>{$("#Restore-result").html(e),$("#Restore").attr("disabled",!1)})}),$("#backupDir").fileBrowser({title:_("Select backup folder to save to"),key:"backupPath"}),$("#backupFile").fileBrowser({title:_("Select backup files to restore"),key:"backupFile",includeFiles:1}),$("#config-components").tabs()},notifications(){$("#testGrowl").on("click",function(){const e={};if(e.host=$.trim($("#growl_host").val()),e.password=$.trim($("#growl_password").val()),!e.host){$("#testGrowl-result").html(_("Please fill out the necessary fields above.")),$("#growl_host").addClass("warning");return}$("#growl_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testGrowl-result").html(loading),$.get(scRoot+"/home/testGrowl",{host:e.host,password:e.password}).done(e=>{$("#testGrowl-result").html(e),$("#testGrowl").prop("disabled",!1)})}),$("#testProwl").on("click",function(){const e={};if(e.api=$.trim($("#prowl_api").val()),e.priority=$("#prowl_priority").val(),!e.api){$("#testProwl-result").html(_("Please fill out the necessary fields above.")),$("#prowl_api").addClass("warning");return}$("#prowl_api").removeClass("warning"),$(this).prop("disabled",!0),$("#testProwl-result").html(loading),$.get(scRoot+"/home/testProwl",{prowl_api:e.api,prowl_priority:e.priority}).done(e=>{$("#testProwl-result").html(e),$("#testProwl").prop("disabled",!1)})}),$("#testKODI").on("click",function(){const e={};if(e.host=$.trim($("#kodi_host").val()),e.username=$.trim($("#kodi_username").val()),e.password=$.trim($("#kodi_password").val()),!e.host){$("#testKODI-result").html(_("Please fill out the necessary fields above.")),$("#kodi_host").addClass("warning");return}$("#kodi_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testKODI-result").html(loading),$.get(scRoot+"/home/testKODI",{host:e.host,username:e.username,password:e.password}).done(e=>{$("#testKODI-result").html(e),$("#testKODI").prop("disabled",!1)})}),$("#testPHT").on("click",function(){const e={};if(e.client={},e.client.host=$.trim($("#plex_client_host").val()),e.client.username=$.trim($("#plex_client_username").val()),e.client.password=$.trim($("#plex_client_password").val()),!e.client.host){$("#testPHT-result").html(_("Please fill out the necessary fields above.")),$("#plex_client_host").addClass("warning");return}$("#plex_client_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testPHT-result").html(loading),$.get(scRoot+"/home/testPHT",{host:e.client.host,username:e.client.username,password:e.client.password}).done(e=>{$("#testPHT-result").html(e),$("#testPHT").prop("disabled",!1)})}),$("#testPMS").on("click",function(){const e={};if(e.server={},e.server.host=$.trim($("#plex_server_host").val()),e.server.username=$.trim($("#plex_server_username").val()),e.server.password=$.trim($("#plex_server_password").val()),e.server.token=$.trim($("#plex_server_token").val()),!e.server.host){$("#testPMS-result").html(_("Please fill out the necessary fields above.")),$("#plex_server_host").addClass("warning");return}$("#plex_server_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testPMS-result").html(loading),$.get(scRoot+"/home/testPMS",{host:e.server.host,username:e.server.username,password:e.server.password,plex_server_token:e.server.token}).done(e=>{$("#testPMS-result").html(e),$("#testPMS").prop("disabled",!1)})}),$("#testEMBY").on("click",function(){const e={};if(e.host=$("#emby_host").val(),e.apikey=$("#emby_apikey").val(),!e.host||!e.apikey){$("#testEMBY-result").html(_("Please fill out the necessary fields above.")),e.host?$("#emby_host").removeClass("warning"):$("#emby_host").addClass("warning"),e.apikey?$("#emby_apikey").removeClass("warning"):$("#emby_apikey").addClass("warning");return}$("#emby_host,#emby_apikey").removeClass("warning"),$(this).prop("disabled",!0),$("#testEMBY-result").html(loading),$.get(scRoot+"/home/testEMBY",{host:e.host,emby_apikey:e.apikey}).done(e=>{$("#testEMBY-result").html(e),$("#testEMBY").prop("disabled",!1)})}),$("#testBoxcar2").on("click",function(){const e={};if(e.accesstoken=$.trim($("#boxcar2_accesstoken").val()),!e.accesstoken){$("#testBoxcar2-result").html(_("Please fill out the necessary fields above.")),$("#boxcar2_accesstoken").addClass("warning");return}$("#boxcar2_accesstoken").removeClass("warning"),$(this).prop("disabled",!0),$("#testBoxcar2-result").html(loading),$.get(scRoot+"/home/testBoxcar2",{accesstoken:e.accesstoken}).done(e=>{$("#testBoxcar2-result").html(e),$("#testBoxcar2").prop("disabled",!1)})}),$("#testPushover").on("click",function(){const e={};if(e.userkey=$("#pushover_userkey").val(),e.apikey=$("#pushover_apikey").val(),!e.userkey||!e.apikey){$("#testPushover-result").html(_("Please fill out the necessary fields above.")),e.userkey?$("#pushover_userkey").removeClass("warning"):$("#pushover_userkey").addClass("warning"),e.apikey?$("#pushover_apikey").removeClass("warning"):$("#pushover_apikey").addClass("warning");return}$("#pushover_userkey,#pushover_apikey").removeClass("warning"),$(this).prop("disabled",!0),$("#testPushover-result").html(loading),$.get(scRoot+"/home/testPushover",{userKey:e.userkey,apiKey:e.apikey}).done(e=>{$("#testPushover-result").html(e),$("#testPushover").prop("disabled",!1)})}),$("#testLibnotify").on("click",()=>{$("#testLibnotify-result").html(loading),$.get(scRoot+"/home/testLibnotify",e=>{$("#testLibnotify-result").html(e)})}),$("#twitterStep1").on("click",()=>{$("#testTwitter-result").html(loading),$.get(scRoot+"/home/twitterStep1",e=>{window.open(e)}).done(()=>{$("#testTwitter-result").html(_("<b>Step 1:</b> Confirm Authorization"))})}),$("#twitterStep2").on("click",()=>{const e={};if(e.key=$.trim($("#twitter_key").val()),!e.key){$("#testTwitter-result").html(_("Please fill out the necessary fields above.")),$("#twitter_key").addClass("warning");return}$("#twitter_key").removeClass("warning"),$("#testTwitter-result").html(loading),$.get(scRoot+"/home/twitterStep2",{key:e.key},e=>{$("#testTwitter-result").html(e)})}),$("#testTwitter").on("click",()=>{$.post(scRoot+"/home/testTwitter",e=>{$("#testTwitter-result").html(e)})}),$("#testTwilio").on("click",()=>{$("#testTwilio").addClass("disabled"),$.post(scRoot+"/home/testTwilio",e=>{$("#testTwilio-result").html(e)}).always(()=>{$("#testTwilio").removeClass("disabled")})}),$("#testSlack").on("click",()=>{$.post(scRoot+"/home/testSlack",e=>{$("#testSlack-result").html(e)})}),$("#testMattermost").on("click",()=>{$.post(scRoot+"/home/testMattermost",e=>{$("#testMattermost-result").html(e)})}),$("#testMattermostBot").on("click",()=>{$.post(scRoot+"/home/testMattermostBot",e=>{$("#testMattermostBot-result").html(e)})}),$("#testRocketChat").on("click",()=>{$.post(scRoot+"/home/testRocketChat",e=>{$("#testRocketChat-result").html(e)})}),$("#testMatrix").on("click",()=>{$.post(scRoot+"/home/testMatrix",e=>{$("#testMatrix-result").html(e)})}),$("#testDiscord").on("click",()=>{const e={},t=$("#discord_webhook");if(e.webhook=t.val(),!e.webhook){t.focus(),notifyModal("Please fill in the webhook address");return}e.name=$("#discord_name").val(),e.avatar=$("#discord_avatar_url").val(),e.tts=$("#discord_tts").val(),$("#testDiscord").prop("disabled",!0),$("#testDiscord-result").html(loading),$.get(scRoot+"/home/testDiscord",{webhook:e.webhook,name:e.name,avatar:e.avatar,tts:e.tts}).done(e=>{$("#testDiscord-result").html(e),$("#testDiscord").prop("disabled",!1)})}),$("#settingsNMJ").on("click",()=>{const e={};if(!$("#nmj_host").val()){$("#nmj_host").focus(),notifyModal("Please fill in the Popcorn IP address");return}$("#testNMJ-result").html(loading),e.host=$("#nmj_host").val(),$.post(scRoot+"/home/settingsNMJ",{host:e.host},e=>{e===null&&($("#nmj_database").removeAttr("readonly"),$("#nmj_mount").removeAttr("readonly"));const t=$.parseJSON(e);$("#testNMJ-result").html(t.message),$("#nmj_database").val(t.database),$("#nmj_mount").val(t.mount),t.database?$("#nmj_database").attr("readonly",!0):$("#nmj_database").removeAttr("readonly"),t.mount?$("#nmj_mount").attr("readonly",!0):$("#nmj_mount").removeAttr("readonly")})}),$("#testNMJ").on("click",function(){const e={};if(e.host=$.trim($("#nmj_host").val()),e.database=$("#nmj_database").val(),e.mount=$("#nmj_mount").val(),!e.host){$("#testNMJ-result").html(_("Please fill out the necessary fields above.")),$("#nmj_host").addClass("warning");return}$("#nmj_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testNMJ-result").html(loading),$.post(scRoot+"/home/testNMJ",{host:e.host,database:e.database,mount:e.mount}).done(e=>{$("#testNMJ-result").html(e),$("#testNMJ").prop("disabled",!1)})}),$("#settingsNMJv2").on("click",()=>{const e={};if(!$("#nmjv2_host").val()){$("#nmjv2_host").focus(),notifyModal("Please fill in the Popcorn IP address","modal");return}$("#testNMJv2-result").html(loading),e.host=$("#nmjv2_host").val(),e.dbloc="";const t=document.getElementsByName("nmjv2_dbloc");for(const n of t)if(n.checked){e.dbloc=n.value;break}e.dbinstance=$("#NMJv2db_instance").val(),$.post(scRoot+"/home/settingsNMJv2",{host:e.host,dbloc:e.dbloc,instance:e.dbinstance},e=>{e===null&&$("#nmjv2_database").removeAttr("readonly");const t=$.parseJSON(e);$("#testNMJv2-result").html(t.message),$("#nmjv2_database").val(t.database),t.database?$("#nmjv2_database").attr("readonly",!0):$("#nmjv2_database").removeAttr("readonly")})}),$("#testNMJv2").on("click",function(){const e={};if(e.host=$.trim($("#nmjv2_host").val()),!e.host){$("#testNMJv2-result").html(_("Please fill out the necessary fields above.")),$("#nmjv2_host").addClass("warning");return}$("#nmjv2_host").removeClass("warning"),$(this).prop("disabled",!0),$("#testNMJv2-result").html(loading),$.post(scRoot+"/home/testNMJv2",{host:e.host}).done(e=>{$("#testNMJv2-result").html(e),$("#testNMJv2").prop("disabled",!1)})}),$("#testFreeMobile").on("click",function(){const e={};if(e.id=$.trim($("#freemobile_id").val()),e.apikey=$.trim($("#freemobile_apikey").val()),!e.id||!e.apikey){$("#testFreeMobile-result").html(_("Please fill out the necessary fields above.")),e.id?$("#freemobile_id").removeClass("warning"):$("#freemobile_id").addClass("warning"),e.apikey?$("#freemobile_apikey").removeClass("warning"):$("#freemobile_apikey").addClass("warning");return}$("#freemobile_id,#freemobile_apikey").removeClass("warning"),$(this).prop("disabled",!0),$("#testFreeMobile-result").html(loading),$.post(scRoot+"/home/testFreeMobile",{freemobile_id:e.id,freemobile_apikey:e.apikey}).done(e=>{$("#testFreeMobile-result").html(e),$("#testFreeMobile").prop("disabled",!1)})}),$("#testTelegram").on("click",function(){const e={};if(e.id=$.trim($("#telegram_id").val()),e.apikey=$.trim($("#telegram_apikey").val()),!e.id||!e.apikey){$("#testTelegram-result").html(_("Please fill out the necessary fields above.")),e.id?$("#telegram_id").removeClass("warning"):$("#telegram_id").addClass("warning"),e.apikey?$("#telegram_apikey").removeClass("warning"):$("#telegram_apikey").addClass("warning");return}$("#telegram_id,#telegram_apikey").removeClass("warning"),$(this).prop("disabled",!0),$("#testTelegram-result").html(loading),$.post(scRoot+"/home/testTelegram",{telegram_id:e.id,telegram_apikey:e.apikey}).done(e=>{$("#testTelegram-result").html(e),$("#testTelegram").prop("disabled",!1)})}),$("#testJoin").on("click",function(){const e={};if(e.id=$.trim($("#join_id").val()),e.apikey=$.trim($("#join_apikey").val()),!e.id||!e.apikey){$("#testJoin-result").html(_("Please fill out the necessary fields above.")),e.id?$("#join_id").removeClass("warning"):$("#join_id").addClass("warning"),e.apikey?$("#join_apikey").removeClass("warning"):$("#join_apikey").addClass("warning");return}$("#join_id,#join_apikey").removeClass("warning"),$(this).prop("disabled",!0),$("#testJoin-result").html(loading),$.post(scRoot+"/home/testJoin",{join_id:e.id,join_apikey:e.apikey}).done(e=>{$("#testJoin-result").html(e),$("#testJoin").prop("disabled",!1)})}),$("#TraktGetPin").on("click",()=>{window.open($("#trakt_pin_url").val(),"popUp","toolbar=no, scrollbars=no, resizable=no, top=200, left=200, width=650, height=550"),$("#trakt_pin").removeClass("hide")}),$("#trakt_pin").on("keyup change",()=>{$("#trakt_pin").val().length===0?($("#TraktGetPin").removeClass("hide"),$("#authTrakt").addClass("hide")):($("#TraktGetPin").addClass("hide"),$("#authTrakt").removeClass("hide"))}),$("#authTrakt").on("click",()=>{const e={};e.pin=$("#trakt_pin").val(),e.pin.length>0&&$.post(scRoot+"/home/getTraktToken",{trakt_pin:e.pin}).done(e=>{$("#testTrakt-result").html(e),$("#authTrakt").addClass("hide"),$("#trakt_pin").addClass("hide"),$("#TraktGetPin").addClass("hide")})}),$("#testTrakt").on("click",function(){const e={};if(e.username=$.trim($("#trakt_username").val()),e.trendingBlacklist=$.trim($("#trakt_blacklist_name").val()),!e.username){$("#testTrakt-result").html(_("Please fill out the necessary fields above.")),e.username?$("#trakt_username").removeClass("warning"):$("#trakt_username").addClass("warning");return}if(/\s/g.test(e.trendingBlacklist)){$("#testTrakt-result").html(_("Check blacklist name; the value needs to be a trakt slug")),$("#trakt_blacklist_name").addClass("warning");return}$("#trakt_username").removeClass("warning"),$("#trakt_blacklist_name").removeClass("warning"),$(this).prop("disabled",!0),$("#testTrakt-result").html(loading),$.post(scRoot+"/home/testTrakt",{username:e.username,blacklist_name:e.trendingBlacklist}).done(e=>{$("#testTrakt-result").html(e),$("#testTrakt").prop("disabled",!1)})}),$("#testEmail").on("click",()=>{const s=$("#testEmail-result");s.html(loading);const o=$("#email_host").val().length>0?$("#email_host").val():null,n=$("#email_port").val().length>0?$("#email_port").val():null,i=$("#email_tls").is(":checked")?1:0,a=$("#email_from").val().length>0?$("#email_from").val():"root@localhost",r=$("#email_user").val().trim(),c=$("#email_password").val();let e="",t="";o===null&&(e+='<li style="color: red;">You must specify an SMTP hostname!</li>'),n===null?e+='<li style="color: red;">You must specify an SMTP port!</li>':(n.match(/^\d+$/)===null||Number.parseInt(n,10)>65535)&&(e+='<li style="color: red;">SMTP port must be between 0 and 65535!</li>'),e.length>0?(e="<ol>"+e+"</ol>",s.html(e)):(t=prompt("Enter an email address to send the test to:",null),t===null||t.length===0||t.match(/.*@.*/)===null?s.html('<p style="color: red;">'+_("You must provide a recipient email address!")+"</p>"):$.post(scRoot+"/home/testEmail",{host:o,port:n,smtp_from:a,use_tls:i,user:r,pwd:c,to:t},e=>{$("#testEmail-result").html(e)}))}),$("#testPushalot").on("click",function(){const e={};if(e.authToken=$.trim($("#pushalot_authorizationtoken").val()),!e.authToken){$("#testPushalot-result").html(_("Please fill out the necessary fields above.")),$("#pushalot_authorizationtoken").addClass("warning");return}$("#pushalot_authorizationtoken").removeClass("warning"),$(this).prop("disabled",!0),$("#testPushalot-result").html(loading),$.post(scRoot+"/home/testPushalot",{authorizationToken:e.authToken}).done(e=>{$("#testPushalot-result").html(e),$("#testPushalot").prop("disabled",!1)})}),$("#testPushbullet").on("click",function(){const e={};if(e.api=$.trim($("#pushbullet_api").val()),!e.api){$("#testPushbullet-result").html(_("Please fill out the necessary fields above.")),$("#pushbullet_api").addClass("warning");return}$("#pushbullet_api").removeClass("warning"),$(this).prop("disabled",!0),$("#testPushbullet-result").html(loading),$.post(scRoot+"/home/testPushbullet",{api:e.api}).done(e=>{$("#testPushbullet-result").html(e),$("#testPushbullet").prop("disabled",!1)})});function t(e){const t={};if(t.api=$("#pushbullet_api").val(),e&&$("#testPushbullet-result").html(loading),!t.api)return $("#testPushbullet-result").html(_("You didn't supply a Pushbullet api key")),$("#pushbullet_api").focus(),!1;$.post(scRoot+"/home/getPushbulletDevices",{api:t.api},n=>{t.devices=$.parseJSON(n).devices,t.currentDevice=$("#pushbullet_device").val(),$("#pushbullet_device_list").html("");for(let e=0;e<t.devices.length;e++)t.devices[e].active===!0&&(t.currentDevice===t.devices[e].iden?$("#pushbullet_device_list").append('<option value="'+t.devices[e].iden+'" selected>'+t.devices[e].nickname+"</option>"):$("#pushbullet_device_list").append('<option value="'+t.devices[e].iden+'">'+t.devices[e].nickname+"</option>"));$("#pushbullet_device_list").prepend('<option value="" '+(t.currentDevice===""?"selected":"")+">All devices</option>"),e&&$("#testPushbullet-result").html(e)}),$("#pushbullet_device_list").on("change",()=>{$("#pushbullet_device").val($("#pushbullet_device_list").val()),$("#testPushbullet-result").html(_("Don't forget to save your new pushbullet settings."))}),$.post(scRoot+"/home/getPushbulletChannels",{api:t.api},n=>{if(t.channels=$.parseJSON(n).channels,t.currentChannel=$("#pushbullet_channel").val(),$("#pushbullet_channel_list").html(""),t.channels.length>0){for(let e=0;e<t.channels.length;e++)t.channels[e].active===!0?$("#pushbullet_channel_list").append('<option value="'+t.channels[e].tag+'" selected>'+t.channels[e].name+"</option>"):$("#pushbullet_channel_list").append('<option value="'+t.channels[e].tag+'">'+t.channels[e].name+"</option>");$("#pushbullet_channel_list").prepend('<option value="" '+(t.currentChannel?"selected":"")+">No Channel</option>"),$("#pushbullet_channel_list").prop("disabled",!1)}else $("#pushbullet_channel_list").prepend("<option value>No Channels</option>"),$("#pushbullet_channel_list").prop("disabled",!0);e&&$("#testPushbullet-result").html(e),$("#pushbullet_channel_list").on("change",()=>{$("#pushbullet_channel").val($("#pushbullet_channel_list").val()),$("#testPushbullet-result").html(_("Don't forget to save your new pushbullet settings."))})})}$("#getPushbulletDevices").on("click",()=>{t("Device list updated. Please choose a device to push to.")}),t(),$("#email_show").on("change",()=>{const e=Number.parseInt($("#email_show").val(),10);$.getJSON(scRoot+"/home/loadShowNotifyLists",t=>{t._size>0&&$("#email_show_list").val(e>=0?t[e.toString()].list:"")})}),$("#prowl_show").on("change",()=>{const e=Number.parseInt($("#prowl_show").val(),10);$.getJSON(scRoot+"/home/loadShowNotifyLists",t=>{t._size>0&&$("#prowl_show_list").val(e>=0?t[e.toString()].prowl_notify_list:"")})});function e(){$.getJSON(scRoot+"/home/loadShowNotifyLists",e=>{if(e._size===0)return;const s=[];for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&t.charAt(0)!=="_"&&s.push(e[t]);const t=s.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0);let n='<option value="-1">-- Select --</option>';for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].id&&t[e].name&&(n+='<option value="'+t[e].id+'">'+$("<div>").text(t[e].name).html()+"</option>");$("#email_show").html(n),$("#email_show_list").val(""),$("#prowl_show").html(n),$("#prowl_show_list").val("")})}e(),$("#email_show").on("notify",()=>{e()}),$("#prowl_show").on("notify",()=>{e()}),$("#email_show_save").on("click",()=>{$.post(scRoot+"/home/saveShowNotifyList",{show:$("#email_show").val(),emails:$("#email_show_list").val()},()=>{e()})}),$("#prowl_show_save").on("click",()=>{$.post(scRoot+"/home/saveShowNotifyList",{show:$("#prowl_show").val(),prowlAPIs:$("#prowl_show_list").val()},()=>{e()})}),$("#use_plex_server").on("click",function(){$(this).is(":checked")?$(".plexinfo").removeClass("hide"):$(".plexinfo").addClass("hide")})},postProcessing(){$("#config-components").tabs(),$("#tv_download_dir").fileBrowser({title:_("Select TV Download Directory")}),$("#unpack_dir").fileBrowser({title:_("Select Unpack Directory")});const t=function(){let e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}();function l(){$.post(scRoot+"/config/postProcessing/isRarSupported",e=>{e!=="supported"&&($("#unpack").qtip("option",{"content.text":"Unrar Executable not found.","style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#unpack").qtip("toggle",!0),$("#unpack").css("background-color","#FFFFDD"))})}function e(){const e={};e.pattern=$("#naming_pattern").val(),e.multi=$("#naming_multi_ep :selected").val(),e.animeType=$('input[name="naming_anime"]:checked').val(),$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e.pattern},e=>{e?($("#naming_example").text(e+".ext"),$("#naming_example_div").show()):$("#naming_example_div").hide()}),$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e.pattern,multi:e.multi},e=>{e?($("#naming_example_multi").text(e+".ext"),$("#naming_example_multi_div").show()):$("#naming_example_multi_div").hide()}),$.post(scRoot+"/config/postProcessing/isNamingValid",{pattern:e.pattern,multi:e.multi},e=>{let t;e==="invalid"?(t=_("This pattern is invalid."),$("#naming_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_pattern").qtip("toggle",!0),$("#naming_pattern").css("background-color","#FFDDDD")):e==="seasonfolders"?(t=_('This pattern would be invalid without the folders, using it will force "Season Folders" on for all shows.'),$("#naming_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_pattern").qtip("toggle",!0),$("#naming_pattern").css("background-color","#FFFFDD")):(t=_("This pattern is valid."),$("#naming_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-green"}),$("#naming_pattern").qtip("toggle",!1),$("#naming_pattern").css("background-color","#FFFFFF")),$("#naming_pattern").attr("title",t)})}function a(){const e=$("#naming_abd_pattern").val();$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e,abd:"True"},e=>{e?($("#naming_abd_example").text(e+".ext"),$("#naming_abd_example_div").show()):$("#naming_abd_example_div").hide()}),$.post(scRoot+"/config/postProcessing/isNamingValid",{pattern:e,abd:"True"},e=>{let t;e==="invalid"?(t=_("This pattern is invalid."),$("#naming_abd_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_abd_pattern").qtip("toggle",!0),$("#naming_abd_pattern").css("background-color","#FFDDDD")):e==="seasonfolders"?(t=_('This pattern would be invalid without the folders, using it will force "Season Folders" on for all shows.'),$("#naming_abd_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_abd_pattern").qtip("toggle",!0),$("#naming_abd_pattern").css("background-color","#FFFFDD")):(t=_("This pattern is valid."),$("#naming_abd_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-green"}),$("#naming_abd_pattern").qtip("toggle",!1),$("#naming_abd_pattern").css("background-color","#FFFFFF")),$("#naming_abd_pattern").attr("title",t)})}function r(){const e=$("#naming_sports_pattern").val();$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e,sports:"True"},e=>{e?($("#naming_sports_example").text(e+".ext"),$("#naming_sports_example_div").show()):$("#naming_sports_example_div").hide()}),$.post(scRoot+"/config/postProcessing/isNamingValid",{pattern:e,sports:"True"},e=>{let t;e==="invalid"?(t=_("This pattern is invalid."),$("#naming_sports_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_sports_pattern").qtip("toggle",!0),$("#naming_sports_pattern").css("background-color","#FFDDDD")):e==="seasonfolders"?(t=_('This pattern would be invalid without the folders, using it will force "Season Folders" on for all shows.'),$("#naming_sports_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),$("#naming_sports_pattern").qtip("toggle",!0),$("#naming_sports_pattern").css("background-color","#FFFFDD")):(t=_("This pattern is valid."),$("#naming_sports_pattern").qtip("option",{"content.text":t,"style.classes":"qtip-rounded qtip-shadow qtip-green"}),$("#naming_sports_pattern").qtip("toggle",!1),$("#naming_sports_pattern").css("background-color","#FFFFFF")),$("#naming_sports_pattern").attr("title",t)})}function n(){const e={};e.pattern=$("#naming_anime_pattern").val(),e.multi=$("#naming_anime_multi_ep :selected").val(),e.animeType=$('input[name="naming_anime"]:checked').val(),$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e.pattern,anime_type:e.animeType},e=>{e?($("#naming_example_anime").text(e+".ext"),$("#naming_example_anime_div").show()):$("#naming_example_anime_div").hide()}),$.post(scRoot+"/config/postProcessing/testNaming",{pattern:e.pattern,multi:e.multi,anime_type:e.animeType},e=>{e?($("#naming_example_multi_anime").text(e+".ext"),$("#naming_example_multi_anime_div").show()):$("#naming_example_multi_anime_div").hide()}),$.post(scRoot+"/config/postProcessing/isNamingValid",{pattern:e.pattern,multi:e.multi,anime_type:e.animeType},e=>{let n;const t=$("#naming_anime_pattern");e==="invalid"?(n=_("This pattern is invalid."),t.qtip("option",{"content.text":n,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),t.qtip("toggle",!0),t.css("background-color","#FFDDDD")):e==="seasonfolders"?(n=_('This pattern would be invalid without the folders, using it will force "Season Folders" on for all shows.'),t.qtip("option",{"content.text":n,"style.classes":"qtip-rounded qtip-shadow qtip-red"}),t.qtip("toggle",!0),t.css("background-color","#FFFFDD")):(n=_("This pattern is valid."),t.qtip("option",{"content.text":n,"style.classes":"qtip-rounded qtip-shadow qtip-green"}),t.qtip("toggle",!1),t.css("background-color","#FFFFFF")),t.attr("title",n)})}function c(){$("#name_presets :selected").val().toLowerCase()==="custom..."?$("#naming_custom").show():($("#naming_custom").hide(),$("#naming_pattern").val($("#name_presets :selected").attr("id"))),e()}function o(){$("#name_abd_presets :selected").val().toLowerCase()==="custom..."?$("#naming_abd_custom").show():($("#naming_abd_custom").hide(),$("#naming_abd_pattern").val($("#name_abd_presets :selected").attr("id"))),a()}function i(){$("#name_sports_presets :selected").val().toLowerCase()==="custom..."?$("#naming_sports_custom").show():($("#naming_sports_custom").hide(),$("#naming_sports_pattern").val($("#name_sports_presets :selected").attr("id"))),r()}function s(){$("#name_anime_presets :selected").val().toLowerCase()==="custom..."?$("#naming_anime_custom").show():($("#naming_anime_custom").hide(),$("#naming_anime_pattern").val($("#name_anime_presets :selected").attr("id"))),n()}Number.parseInt($("#unpack").val(),10)!==1&&$("#content_unpack").hide(),$("#unpack").on("change",function(){const e=Number.parseInt(this.value,10);(e===2||e===0)&&($("#content_unpack").fadeOut("fast","linear"),$("#unpack").qtip("toggle",!1)),e===1&&($("#content_unpack").fadeIn("fast","linear"),l())}),$("#name_presets").on("change",c),$("#name_abd_presets").on("change",o),$("#naming_custom_abd").on("change",o),$("#name_sports_presets").on("change",i),$("#naming_custom_sports").on("change",i),$("#name_anime_presets").on("change",s),$("#naming_custom_anime").on("change",s),$('input[name="naming_anime"]').on("click",s),$("#naming_multi_ep").on("change",e),$("#naming_pattern").on("focusout",e),$("#naming_pattern").on("keyup",()=>{t(e,500)}),$("#naming_anime_multi_ep").on("change",n),$("#naming_anime_pattern").on("focusout",n),$("#naming_anime_pattern").on("keyup",()=>{t(n,500)}),$("#naming_abd_pattern").on("focusout",e),$("#naming_abd_pattern").on("keyup",()=>{t(a,500)}),$("#naming_sports_pattern").on("focusout",e),$("#naming_sports_pattern").on("keyup",()=>{t(r,500)}),$("#naming_anime_pattern").on("focusout",e),$("#naming_anime_pattern").on("keyup",()=>{t(n,500)}),$("#show_naming_key").on("click",()=>{$("#naming_key").toggle()}),$("#show_naming_abd_key").on("click",()=>{$("#naming_abd_key").toggle()}),$("#show_naming_sports_key").on("click",()=>{$("#naming_sports_key").toggle()}),$("#show_naming_anime_key").on("click",()=>{$("#naming_anime_key").toggle()}),$("#do_custom").on("click",()=>{$("#naming_pattern").val($("#name_presets :selected").attr("id")),$("#naming_custom").show(),$("#naming_pattern").focus()}),c(),o(),i(),s(),$("#metadataType").on("change keyup",function(){$(this).showHideMetadata()}),$.fn.showHideMetadata=function(){$(".metadataDiv").each(function(){const e=$(this).attr("id"),t=$("#metadataType :selected").val();t===e?$(this).show():$(this).hide()})},$(this).showHideMetadata(),$(".metadata_checkbox").on("click",function(){$(this).refreshMetadataConfig(!1)}),$.fn.refreshMetadataConfig=function(e){let n=0,t="";$(".metadataDiv").each(function(){const e=$(this).attr("id"),s=[],f=$("#"+e+"_show_metadata").is(":checked"),c=$("#"+e+"_episode_metadata").is(":checked"),a=$("#"+e+"_fanart").is(":checked"),r=$("#"+e+"_poster").is(":checked"),i=$("#"+e+"_banner").is(":checked"),l=$("#"+e+"_episode_thumbnails").is(":checked"),d=$("#"+e+"_season_posters").is(":checked"),u=$("#"+e+"_season_banners").is(":checked"),h=$("#"+e+"_season_all_poster").is(":checked"),m=$("#"+e+"_season_all_banner").is(":checked");s.push(f?"1":"0",c?"1":"0",a?"1":"0",r?"1":"0",i?"1":"0",l?"1":"0",d?"1":"0",u?"1":"0",h?"1":"0",m?"1":"0");let o=0;for(const e of s)o+=Number.parseInt(e,10);o>n&&(n=o,t=e),$("#"+e+"_eg_show_metadata").attr("class",f?"enabled":"disabled"),$("#"+e+"_eg_episode_metadata").attr("class",c?"enabled":"disabled"),$("#"+e+"_eg_fanart").attr("class",a?"enabled":"disabled"),$("#"+e+"_eg_poster").attr("class",r?"enabled":"disabled"),$("#"+e+"_eg_banner").attr("class",i?"enabled":"disabled"),$("#"+e+"_eg_episode_thumbnails").attr("class",l?"enabled":"disabled"),$("#"+e+"_eg_season_posters").attr("class",d?"enabled":"disabled"),$("#"+e+"_eg_season_banners").attr("class",u?"enabled":"disabled"),$("#"+e+"_eg_season_all_poster").attr("class",h?"enabled":"disabled"),$("#"+e+"_eg_season_all_banner").attr("class",m?"enabled":"disabled"),$("#"+e+"_data").val(s.join("|"))}),t!==""&&e&&($("#metadataType option[value="+t+"]").attr("selected","selected"),$(this).showHideMetadata())},$(this).refreshMetadataConfig(!0),$("img[title]").qtip({position:{viewport:$(window),at:"bottom center",my:"top right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-shadow qtip-dark"}}),$("i[title]").qtip({position:{viewport:$(window),at:"top center",my:"bottom center"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}}),$(".custom-pattern,#unpack").qtip({content:"validating...",show:{event:!1,ready:!1},hide:!1,position:{viewport:$(window),at:"center left",my:"center right"},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow qtip-red"}})},search(){$("#config-components").tabs(),$("#nzb_dir").fileBrowser({title:_("Select .nzb black hole/watch location")}),$("#torrent_dir").fileBrowser({title:_("Select torrent black hole/watch location")}),$("#torrent_path").fileBrowser({title:_("Select torrent download location")}),$("#torrent_path_incomplete").fileBrowser({title:_("Select torrent incomplete download location")}),$.fn.nzbMethodHandler=function(){const e=$("#nzb_method :selected").val(),t="#blackhole_settings",n="#sabnzbd_settings",s="#testSABnzbd",o="#testSABnzbd_result",i="#nzbget_settings",a="#download_station_settings",r="#testDSM",c="#testDSM_result";$("#nzb_method_icon").removeClass((e,t)=>(t.match(/(^|\s)add-client-icon-\S+/g)||[]).join(" ")),$("#nzb_method_icon").addClass("add-client-icon-"+e.replace("_","-")),$(t).hide(),$(n).hide(),$(s).hide(),$(o).hide(),$(i).hide(),$(a).hide(),$(r).hide(),$(c).hide(),e.toLowerCase()==="blackhole"?$(t).show():e.toLowerCase()==="nzbget"?$(i).show():e.toLowerCase()==="download_station"?($("#host_title").text("Synology host:port"),$("#username_title").text("Synology Username"),$("#password_title").text("Synology Password"),$(a).show(),$(r).show(),$(c).show()):($(n).show(),$(s).show(),$(o).show())},$.torrentMethodHandler=()=>{$("#options_torrent_clients").hide(),$("#options_torrent_blackhole").hide();const t=$("#torrent_method :selected").val();let n="#options_torrent_blackhole",e="";$("#torrent_method_icon").removeClass((e,t)=>(t.match(/(^|\s)add-client-icon-\S+/g)||[]).join(" ")),$("#torrent_method_icon").addClass("add-client-icon-"+t.replace("_","-")),t.toLowerCase()!=="blackhole"&&($("#torrent_host_option").show(),$("#host_desc_torrent").show(),$("#torrent_rpcurl_option").hide(),$("#torrent_auth_type_option").hide(),$("#torrent_verify_cert_option").hide(),$('label[for="torrent_verify_cert"]').text(_("verify SSL certificates for HTTPS requests")),$("#username_title.component-title").text(_("Client username")),$("#torrent_username_option").show(),$("#password_title.component-title").text(_("Client password")),$("#torrent_password_option").show(),$('label[for="torrent_password"]').text(_("(blank for none)")),$("#torrent_path_option").show(),$("#torrent_path_option").find(".fileBrowser").show(),$("#torrent_path_incomplete_option").hide(),$("#path_synology").hide(),$("#torrent_seed_time_option").hide(),$("#torrent_high_bandwidth_option").hide(),$("#torrent_paused_option").show(),$("#torrent_label_option").show(),$("#label_warning_deluge").hide(),$("#label_anime_warning_deluge").hide(),$("#test_torrent_result").text(_("Click below to test")),t.toLowerCase()==="utorrent"?(e="uTorrent",$("#torrent_path_option").hide(),$("#torrent_seed_time_label").text(_("Minimum seeding time is")),$("#torrent_seed_time_option").show(),$("#host_desc_torrent").text(_("URL to your uTorrent client (e.g. http://localhost:8000)"))):t.toLowerCase()==="transmission"?(e="Transmission",$("#torrent_seed_time_label").text(_("Stop seeding when inactive for")),$("#torrent_seed_time_option").show(),$("#torrent_high_bandwidth_option").show(),$("#torrent_path_incomplete_option").show(),$("#torrent_label_option").hide(),$("#torrent_rpcurl_option").show(),$("#host_desc_torrent").text(_("URL to your Transmission client (e.g. http://localhost:9091)"))):t.toLowerCase().startsWith("deluge")?($("#torrent_verify_cert_option").show(),$("#label_warning_deluge").show(),$("#label_anime_warning_deluge").show(),$("#torrent_path_incomplete_option").show(),t.toLowerCase()==="deluged"?(e="Deluge Daemon",$("#torrent_username_option").show(),$("#host_desc_torrent").text(_("IP or Hostname of your Deluge Daemon (e.g. http://localhost:58846)"))):(e="Deluge",$("#torrent_username").prop("value",""),$("#torrent_username_option").hide(),$("#host_desc_torrent").text(_("URL to your Deluge client (e.g. http://localhost:8112)"))),$('label[for="torrent_verify_cert"]').text(_('disable if you get "Deluge: Authentication Error" in your log'))):t.toLowerCase()==="download_station"?(e="Synology DS",$("#torrent_label_option").hide(),$("#torrent_paused_option").hide(),$("#torrent_path_option").find(".fileBrowser").hide(),$("#host_desc_torrent").text(_("URL to your Synology DS client (e.g. http://localhost:5000)")),$("#path_synology").show()):t.toLowerCase()==="rtorrent"?(e="rTorrent",$("#host_desc_torrent").html(_("URL to your rTorrent client (e.g. scgi://localhost:5000 <br> or https://localhost/rutorrent/plugins/httprpc/action.php)")),$("#torrent_verify_cert_option").show(),$("#torrent_auth_type_option").show()):t.toLowerCase()==="qbittorrent"?(e="qBittorrent",$("#torrent_path_option").hide(),$("#label_warning_qbittorrent").show(),$("#label_anime_warning_qbittorrent").show(),$("#torrent_verify_cert_option").show(),$("#host_desc_torrent").text(_("URL to your qBittorrent client (e.g. http://localhost:8080)"))):t.toLowerCase()==="mlnet"?(e="mlnet",$("#torrent_path_option").hide(),$("#torrent_label_option").hide(),$("#torrent_paused_option").hide(),$("#host_desc_torrent").text(_("URL to your MLDonkey (e.g. http://localhost:4080)"))):t.toLowerCase()==="putio"&&(e="putio",$("#torrent_path_option").hide(),$("#torrent_label_option").hide(),$("#torrent_paused_option").hide(),$("#torrent_host_option").hide(),$("#host_desc_torrent").text(_("URL to your putio client (e.g. http://localhost:8080)")),$('label[for="torrent_password"]').html('<a href="'+anonURL+'https://app.put.io/oauth/apps/new" target="_blank">'+_("Create a new OAuth app for put.io")+"</a>"),$("#username_title.component-title").text(_("Put.io Parent Folder")),$("#password_title.component-title").text(_("Put.io OAuth Token"))),$("#host_title").text(e+" host:port"),$("#username_title").text(e+" Username"),$("#password_title").text(e+" Password"),$("#torrent_client").text(e),$("#rpcurl_title").text(e+" RPC URL"),n="#options_torrent_clients"),$(n).show()},$("#torrent_host").on("input",()=>{if($("#torrent_method :selected").val().toLowerCase().startsWith("rtorrent")){const e=$("#torrent_host").val(),t=e.slice(0,7)==="scgi://";t?($("#torrent_username_option").hide(),$("#torrent_username").prop("value",""),$("#torrent_password_option").hide(),$("#torrent_password").prop("value",""),$("#torrent_auth_type_option").hide(),$("#torrent_auth_type option[value=none]").attr("selected","selected")):($("#torrent_username_option").show(),$("#torrent_password_option").show(),$("#torrent_auth_type_option").show())}}),$("#nzb_method").on("change",$(this).nzbMethodHandler),$(this).nzbMethodHandler(),$("#testSABnzbd").on("click",()=>{const e={};$("#testSABnzbd_result").html(loading),e.host=$("#sab_host").val(),e.username=$("#sab_username").val(),e.password=$("#sab_password").val(),e.apiKey=$("#sab_apikey").val(),$.post(scRoot+"/home/testSABnzbd",{host:e.host,username:e.username,password:e.password,apikey:e.apiKey},e=>{$("#testSABnzbd_result").html(e)})}),$("#testDSM").on("click",()=>{const e={};$("#testDSM_result").html(loading),e.host=$("#syno_dsm_host").val(),e.username=$("#syno_dsm_user").val(),e.password=$("#syno_dsm_pass").val(),$.post(scRoot+"/home/testDSM",{host:e.host,username:e.username,password:e.password},e=>{$("#testDSM_result").html(e)})}),$("#torrent_method").on("change",$.torrentMethodHandler),$.torrentMethodHandler(),$("#test_torrent").on("click",()=>{const e={};$("#test_torrent_result").html(loading),e.method=$("#torrent_method :selected").val(),e.host=$("#torrent_host").val(),e.username=$("#torrent_username").val(),e.password=$("#torrent_password").val(),$.post(scRoot+"/home/testTorrent",{torrent_method:e.method,host:e.host,username:e.username,password:e.password},e=>{$("#test_torrent_result").html(e)})}),$("#testFlareSolverr").on("click",function(){const e=$.trim($("#flaresolverr_uri").val());if(!e){$("#testFlaresolverr-result").html(_("Please fill out the necessary fields above.")),$("#flaresolverr_uri").addClass("warning");return}$("#flaresolverr_uri").removeClass("warning"),$(this).prop("disabled",!0),$("#testFlaresolverr-result").html(loading),$.post(scRoot+"/home/testFlareSolverr",{flaresolverr_uri:e}).done(e=>{$("#testFlaresolverr-result").html(e),$("#testFlareSolverr").prop("disabled",!1)})})},subtitles(){$.fn.showHideServices=function(){$(".serviceDiv").each(function(){const e=$(this).attr("id"),t=$("#editAService :selected").val();t+"Div"===e?$(this).show():$(this).hide()})},$.fn.addService=function(e,t,n,s,o,i){if(n.match("/$")===null&&(n+="/"),$("#service_order_list > #"+e).length===0&&i!==!1){let s="";s+='<li class="ui-state-default" id="'+e+'"> ',s+='<input type="checkbox" id="enable_'+e+'" class="service_enabler" CHECKED> ',s+='<a href="'+anonURL+n+'" class="imgLink" target="_new">',s+='<img src="'+scRoot+'/images/services/newznab.gif" alt="'+t+'" width="16" height="16"></a> ',s+=t+"</li>",$("#service_order_list").append(s),$("#service_order_list").sortable("refresh")}},$.fn.deleteService=function(e){$("#service_order_list > #"+e).remove()},$.fn.refreshServiceList=function(){const t=$("#service_order_list").sortable("toArray"),e=[];$.each(t,(t,n)=>{const s=$("#enable_"+n).is(":checked")?"1":"0";e.push(n+":"+s)}),$("#service_order").val(e.join(" "))},$("#editAService").on("change",function(){$(this).showHideServices()}),$(".service_enabler").on("click",function(){$(this).refreshServiceList()}),$(this).showHideServices(),$("#service_order_list").sortable({placeholder:"ui-state-highlight",update(){$(this).refreshServiceList()},create(){$(this).refreshServiceList()}}),$("#service_order_list").disableSelection()},providers(){console.log("This function need to be filled with ConfigProviders.js but can't be as we've got scope issues currently.")}},home:{init(){$("#showTabs").tabs({activate(){$(".show-grid").isotope("layout")}})},index(){$(".resetsorting").on("click",()=>{$("table").trigger("filterReset")}),$("#filterShowName").on("input",__.debounce(()=>{$(".show-grid").isotope({filter(){const e=$(this).find(".show-title").html().trim().toLowerCase();return e.includes($("#filterShowName").val().toLowerCase())}})},500));function t(e){let t=0,o=0,n=0,s=0;e<125?(n=3,s=4):e<175?(t=9,o=40,n=4,s=5):(t=11,o=50,n=6,s=6),$("#posterPopup").remove(),t===void 0?$(".show-details").hide():($(".show-details").show(),$(".show-dlstats, .show-quality").css("fontSize",t),$(".show-network-image").css("width",o)),$(".show-container").css({width:e,borderWidth:s,borderRadius:n})}let e;typeof Storage!="undefined"&&(e=Number.parseInt(localStorage.getItem("posterSize"),10)),(typeof e!="number"||Number.isNaN(e))&&(e=188),t(e),$("#posterSizeSlider").slider({min:75,max:250,value:e,change(e,n){typeof Storage!="undefined"&&localStorage.setItem("posterSize",n.value),t(n.value),$(".show-grid").isotope("layout")}}),$("#rootDirSelect").on("change",()=>{$("#rootDirForm").submit()}),$(".progressbar").each(function(){const e=$(this).data("progress-percentage"),t=Math.max(20,e-e%20);$(this).progressbar({value:e}),$(this).data("progress-text")&&$(this).append('<div class="progressbarText" title="'+$(this).data("progress-tip")+'">'+$(this).data("progress-text")+"</div>"),$(this).find(".ui-progressbar-value").addClass("progress-"+t)}),$("img#network").on("error",function(){$(this).parent().text($(this).attr("alt")),$(this).remove()}),$("#showListTableShows:has(tbody tr), #showListTableAnime:has(tbody tr)").tablesorter({sortList:[[7,1],[2,0]],textExtraction:{0(e){return $(e).find("time").attr("datetime")},1(e){return $(e).find("time").attr("datetime")},2(e){return latinize($(e).text().normalize("NFC"))},3(e){return($(e).find("span").prop("title")||"zunknown").toLowerCase()},4(e){return $(e).find("span").text().toLowerCase()},5(e){const t=$(e).find("div").attr("data-progress-percentage"),s=t===void 0?Number.NEGATIVE_INFINITY:t.length>0&&Number.parseFloat(t)||0,n=$(e).find("div").attr("data-progress-total"),o=n===void 0?Number.NEGATIVE_INFINITY:n.length>0&&Number.parseInt(n,10)||0;return s*100*1e3+o},6(e){return $(e).data("show-size")},7(e){return($(e).find("span").attr("title")||"No").toLowerCase()}},widgets:["saveSort","zebra","stickyHeaders","filter","columnSelector"],headers:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:"digit"},6:{sorter:"digit"},7:{filter:"parsed"}},widgetOptions:{filter_columnFilters:!0,filter_hideFilters:!0,stickyHeaders_offset:50,filter_saveFilters:!1,filter_functions:{5(e,t,n){let s=!1;const o=Math.floor(t%1*1e3),i={"<"(e,t){return e<t},"<="(e,t){return e<=t},">="(e,t){return e>=t},">"(e,t){return e>t}};if(n==="")s=!0;else{let e=n.match(/(<|<=|>=|>)\s?(\d+)/i);if(e){const t=i[e[1]];t(o,Number.parseInt(e[2],10))&&(s=!0)}e=n.match(/(\d+)\s(-|to)\s+(\d+)/i),e&&(e[2]==="-"||e[2]==="to")&&o>=Number.parseInt(e[1],10)&&o<=Number.parseInt(e[3],10)&&(s=!0),e=n.match(/(=)?\s?(\d+)\s?(=)?/i),e&&(e[1]==="="||e[3]==="=")&&Number.parseInt(e[2],10)===o&&(s=!0),!Number.isNaN(Number.parseFloat(n))&&Number.isFinite(n)&&Number.parseInt(n,10)===o&&(s=!0)}return s}},columnSelector_mediaquery:!1},sortStable:!0,sortAppend:[[2,0]]}),$(".show-grid").imagesLoaded(()=>{let e;switch(getMeta("settings.POSTER_SORTBY")){case"progress":{e=["progress","total","name"];break}case"date":{e=["date","status","name"];break}case"status":{e=["status","progress","name"];break}default:{e=getMeta("settings.POSTER_SORTBY");break}}$(".loading-spinner").hide(),$(".show-grid").show().isotope({itemSelector:".show-container",sortBy:e,sortAscending:getMeta("settings.POSTER_SORTDIR"),layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},getSortData:{name(e){const t=$(e).attr("data-name")||"",n=new RegExp("^((?:"+getMeta("settings.GRAMMAR_ARTICLES")+")\\s)","i");return latinize((metaToBool("settings.SORT_ARTICLE")?t:t.replace(n,"")).toLowerCase().normalize("NFC"))},network:"[data-network]",date(e){const t=$(e).attr("data-date");return t.length>0&&Number.parseInt(t,10)||Number.POSITIVE_INFINITY},progress(e){const t=$(e).attr("data-progress");return t.length>0&&Number.parseFloat(t)||0},total(e){const t=$(e).attr("data-progress-total");return t.length>0&&Number.parseInt(t,10)||0},status:"[data-status]"}});let t=null;$(".show-container").on("mouseenter",function(){const e=$(this),n=e.find(".show-network-image");if(n[0].style.cssText!=="width: 0px;")return;t=setTimeout(()=>{t=null,$("#posterPopup").remove();const s=e.clone().attr({id:"posterPopup"}),l=e.offset().left,p=e.width(),f=e.height(),c=e.offset().top;s.css({position:"absolute",margin:0,top:c,left:l,zIndex:9999}),s.find(".show-details").show(),s.on("mouseleave",function(){$(this).animate({height:f+8,width:p+8,top:c,left:l})}),s.appendTo("body");const r=438,a=250;let i=c+e.height()/2-r/2,o=l+e.width()/2-a/2;const n=5,d=$(window).scrollTop(),u=$(window).scrollLeft(),h=d+$(window).innerHeight(),m=u+$(window).innerWidth();i<d+n&&(i=d+n),o<u+n&&(o=u+n),i+r+n>h&&(i=h-r-n),o+a+n>m&&(o=m-a-n),s.animate({top:i,left:o,width:250,height:438})},300)}).on("mouseleave",()=>{t!==null&&clearTimeout(t)})}),$("#layout").on("change",function(){window.location.href=$(this).find("option:selected").val()}),$("#postersort").on("change",function(){let e;switch($(this).val()){case"progress":{e=["progress","total","name"];break}case"date":{e=["date","status","name"];break}case"status":{e=["status","progress","name"];break}default:{e=getMeta("settings.POSTER_SORTBY");break}}$(".show-grid").isotope({layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},sortBy:e,getSortData:{name(e){const t=$(e).attr("data-name")||"",n=new RegExp("^((?:"+getMeta("settings.GRAMMAR_ARTICLES")+")\\s)","i");return latinize((metaToBool("settings.SORT_ARTICLE")?t:t.replace(n,"")).toLowerCase().normalize("NFC"))},network:"[data-network]",date(e){const t=$(e).attr("data-date");return t.length>0&&Number.parseInt(t,10)||Number.POSITIVE_INFINITY},progress(e){const t=$(e).attr("data-progress");return t.length>0&&Number.parseFloat(t)||0},total(e){const t=$(e).attr("data-progress-total");return t.length>0&&Number.parseInt(t,10)||0},status:"[data-status]"}}),$.post($(this).find("option:selected").data("sort"))}),$("#postersortdirection").on("change",function(){$(".show-grid").isotope({layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},sortAscending:$(this).val()==="true",getSortData:{name(e){const t=$(e).attr("data-name")||"",n=new RegExp("^((?:"+getMeta("settings.GRAMMAR_ARTICLES")+")\\s)","i");return latinize((metaToBool("settings.SORT_ARTICLE")?t:t.replace(n,"")).toLowerCase().normalize("NFC"))},network:"[data-network]",date(e){const t=$(e).attr("data-date");return t.length>0&&Number.parseInt(t,10)||Number.POSITIVE_INFINITY},progress(e){const t=$(e).attr("data-progress");return t.length>0&&Number.parseFloat(t)||0},total(e){const t=$(e).attr("data-progress-total");return t.length>0&&Number.parseInt(t,10)||0},status:"[data-status]"}}),$.post($(this).find("option:selected").data("sort"))}),$("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",()=>{$.tablesorter.columnSelector.attachTo($("#showListTableShows"),"#popover-target"),metaToBool("settings.ANIME_SPLIT_HOME")&&$.tablesorter.columnSelector.attachTo($("#showListTableAnime"),"#popover-target")})},displayShow(){if(metaToBool("settings.FANART_BACKGROUND")){const e=getMeta("showBackgroundImage")||scRoot+"/cache/images/"+$("#showID").attr("value")+".fanart.jpg";$.backstretch(e),$(".backstretch").css("opacity",getMeta("settings.FANART_BACKGROUND_OPACITY")).fadeIn("500")}$(".displayShowTable").tablesorter({widgets:["saveSort","stickyHeaders","columnSelector"],widgetOptions:{columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox"/>{name}</label>',columnSelector_mediaquery:!1,columnSelector_cssChecked:"checked",stickyHeaders_offset:50}}),$(".displayShowTable").ajaxEpSearch({colorRow:!0});function t(e){e.on("click.disabled",!1),e.prop("enableClick","1"),e.fadeTo("fast",1)}function n(e){e.off("click.disabled"),e.prop("enableClick","0"),e.fadeTo("fast",.5)}$(".play-on-kodi").on("click",function(){if($(this).prop("enableClick")==="0")return!1;const e=$(this),s=$("#playOnKodiModal");return $("#playOnKodiModal .btn.btn-success").on("click",()=>{n(e),s.modal("hide");const o=e.children("img");o.hide(),e.append($("<span/>").attr({class:"loading-spinner16",title:"Playing"}));const i=e.children("span"),a=$("#kodi-play-host").val();return $.getJSON(e.prop("href")+"&host="+a,e=>{e.result.toLowerCase()==="failure"?(i.prop("class","displayshow-icon-disable"),i.prop("title","Failed")):(o.prop("title","Success"),o.prop("alt","Success"),i.hide(),o.show())}),t(e),!1}),s.modal("show"),!1}),$(".epSubtitlesSearch").on("click",function(){if($(this).prop("enableClick")==="0")return!1;n($(this));const o=$(this).parent(),s=o.siblings(".col-subtitles"),e=$(this).children("span");return e.prop("class","loading-spinner16"),e.prop("title","Searching"),$.getJSON($(this).attr("href"),function(n){if(n.result.toLowerCase()!=="failure"&&n.result.toLowerCase()!=="no subtitles downloaded"){const o=n.subtitles.split(",");s.empty(),$.each(o,(e,t)=>{t!==""&&s.append($("<img/>",{src:scRoot+"/images/subtitles/flags/"+t+".png",alt:t,width:16,height:11}))}),e.prop("class","displayshow-icon-sub"),t($(this))}else e.prop("class","displayshow-icon-disable");e.prop("title",n.result)}),!1}),$(".epRetrySubtitlesSearch").on("click",function(){if($(this).prop("enableClick")==="0")return!1;const e=$(this),s=$("#confirmSubtitleDownloadModal");return $("#confirmSubtitleDownloadModal .btn.btn-success").on("click",()=>{n(e),s.modal("hide");const o=e.children("img");o.hide(),e.append($("<span/>").attr({class:"loading-spinner16",title:"Searching"}));const i=e.children("span");return $.getJSON(e.prop("href"),e=>{e.result.toLowerCase()==="failure"?(i.prop("class","displayshow-icon-disable"),i.prop("title","Failed")):(o.prop("title","Success"),o.prop("alt","Success"),i.hide(),o.show())}),t(e),!1}),s.modal("show"),!1}),$("#seasonJump").on("change",()=>{const t=$("#seasonJump option:selected"),e=t.val();if(e&&e!=="jump"){const n=t.data("season");$("html,body").animate({scrollTop:$("#"+e.slice(1)).offset().top-50},"slow"),$("#collapseSeason-"+n).collapse("show"),location.hash=e}$(this).val("jump")}),$("#seasonJumpLinks a").on("click",e=>{const t=$(e.target).data("season");return $("html,body").animate({scrollTop:$("#"+t).offset().top-50},"slow"),$("#collapseSeason-"+t).collapse("show"),location.hash=t,!1}),$("#prevShow").on("click",()=>{$("#pickShow option:selected").prev("option").prop("selected","selected"),$("#pickShow").change()}),$("#nextShow").on("click",()=>{$("#pickShow option:selected").next("option").prop("selected","selected"),$("#pickShow").change()}),$("#changeStatus").on("click",()=>{const e=[];if($(".epCheck").each(function(){this.checked===!0&&e.push($(this).attr("id"))}),e.length===0)return!1;const t=scRoot+"/home/setStatus",n="show="+$("#showID").attr("value")+"&eps="+e.join("|")+"&status="+$("#statusSelect").val();$.post(t,n,()=>{location.reload(!0)})}),$(".seasonCheck").on("click",function(){const t=this.checked,e=$(this).attr("id");$("#collapseSeason-"+e).collapse("show"),$('.epCheck:visible[id^="'+e+'x"]').each(function(){this.checked=t})});let e=null;$(".epCheck").on("click",function(t){if(!e||!t.shiftKey){e=this;return}const s=this;let n=0;$(".epCheck").each(function(){if(n===2)return!1;n===1&&(this.checked=e.checked),(this===s||this===e)&&n++})}),$(".seriesCheck").on("click",()=>{$(".epCheck:visible").each(function(){this.checked=!0}),$(".seasonCheck:visible").each(function(){this.checked=!0})}),$(".clearAll").on("click",()=>{$(".epCheck:visible").each(function(){this.checked=!1}),$(".seasonCheck:visible").each(function(){this.checked=!1})}),$("#pickShow").on("change",function(){const e=$(this).val();if(e===0)return;window.location.href=scRoot+"/home/displayShow?show="+e}),$("#checkboxControls input").on("change",function(){const e=$(this).attr("id");$(this).showHideRows(e)}),$("#checkboxControls input").each(function(){const e=$(this).is(":checked");$("tr."+$(this).attr("id")).each(function(){e?$(this).show():$(this).hide()})}),$.fn.showHideRows=function(e){const t=$("#checkboxControls > input, #"+e).is(":checked");$("tr."+e).each(function(){t?$(this).show():$(this).hide()}),$("div.seasonheader").each(function(){let t=0;const e=$(this).attr("data-season-id");$("tr.season-"+e+" :visible").each(()=>{t++}),t===0?($(this).hide(),$("#"+e+"-cols").hide()):($(this).show(),$("#"+e+"-cols").show())})};function o(e,t,n,s){const o=$("#showID").val(),i=$("#indexer").val();n===""&&(n=null),s===""&&(s=null),$.getJSON(scRoot+"/home/setSceneNumbering",{show:o,indexer:i,forSeason:e,forEpisode:t,sceneSeason:n,sceneEpisode:s},n=>{n.sceneSeason===null||n.sceneEpisode===null?$("#sceneSeasonXEpisode_"+o+"_"+e+"_"+t).val(""):$("#sceneSeasonXEpisode_"+o+"_"+e+"_"+t).val(n.sceneSeason+"x"+n.sceneEpisode),n.success||notifyModal(n.errorMessage?n.errorMessage:"Update failed.")})}function i(e,t){const n=$("#showID").val(),s=$("#indexer").val();t===""&&(t=null),$.getJSON(scRoot+"/home/setSceneNumbering",{show:n,indexer:s,forAbsolute:e,sceneAbsolute:t},t=>{t.sceneAbsolute===null?$("#sceneAbsolute_"+n+"_"+e).val(""):$("#sceneAbsolute_"+n+"_"+e).val(t.sceneAbsolute),t.success||notifyModal(t.errorMessage?t.errorMessage:"Update failed.")})}function s(e,t){return e?($(t).css({"background-color":"#90EE90",color:"#FFF","font-weight":"bold"}),!0):($(t).css({"background-color":"#FF0000",color:"#FFF!important","font-weight":"bold"}),!1)}$(".sceneSeasonXEpisode").on("change",function(){$(this).val($(this).val().replace(/[^\dxX]*/g,""));const a=$(this).attr("data-for-season"),c=$(this).attr("data-for-episode"),t=$(this).val().match(/^(\d+)x(\d+)$/i),r=$(this).val().match(/^(\d+)$/i);let n=null,i=null,e=!1;t?(n=t[1],i=t[2],e=s(!0,$(this))):r?(n=a,i=r[1],e=s(!0,$(this))):e=s(!1,$(this)),e&&o(a,c,n,i)}),$(".sceneAbsolute").on("change",function(){$(this).val($(this).val().replace(/[^\dxX]*/g,""));const n=$(this).attr("data-for-absolute"),e=$(this).val().match(/^(\d{1,3})$/i);let t=null;e&&(t=e[1]),i(n,t)}),$(".addQTip").each(function(){$(this).css({cursor:"help","text-shadow":"0px 0px 0.5px #666"}),$(this).qtip({show:{solo:!0},position:{viewport:$(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}})}),$.fn.generateStars=function(){return this.each((e,t)=>{$(t).html($("<span/>").width($(t).text()*12))})},$(".imdbstars").generateStars(),$("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",()=>{$(".displayShowTable").each((e,t)=>{$.tablesorter.columnSelector.attachTo(t,"#popover-target")})}),$(()=>{$(".collapse.toggle").on("hide.bs.collapse",function(){const e=/collapseSeason-(\d+)/g,t=e.exec(this.id);$("#showseason-"+t[1]).text(_("Show Episodes"))}),$(".collapse.toggle").on("show.bs.collapse",function(){const e=/collapseSeason-(\d+)/g,t=e.exec(this.id);$("#showseason-"+t[1]).text(_("Hide Episodes"))})})},editShow(){$("#location").fileBrowser({title:_("Select Show Location")}),SICKCHILL.common.QualityChooser.init(),$("#submit").on("click",()=>{const e=$("#exceptions_list").find("optgroup").get().map(e=>{const n=$(e).data("season"),t=$(e).find("option:enabled").get().map(e=>{const t=$(e).val();return encodeURIComponent(t)}).join("|");return t.length===0?null:[n,t].join(":")}).filter(Boolean);$("#exceptions").val(e),metaToBool("show.is_anime")&&generateBlackWhiteList()}),$("#addSceneName").on("click",()=>{const n=$("#SceneSeason").find(":selected").data("season"),e=$("#SceneName").val(),t=$('.exceptions_list optgroup[data-season="'+n+'"]').get()[0],s=$(t).find("option.empty"),o=new Set($(t).find("option:not(.empty)").get().map(e=>$(e).val()));if(o.has(e)||e.trim()===""){$("#SceneName").val("");return}const i=$("<option data-season="+n+">").text(e).val(e);$(t).append(i),s.remove(),$("#SceneName").val("")}),$("#removeSceneName").on("click",()=>{const e=$("#exceptions_list").find("option:selected"),t=e.closest("optgroup");if(t.find("option").length<2){const e=$('<option disabled class="empty">');e.text(_("None")),t.append(e)}e.remove()}),$(".custom-image").imageSelector()},manual_search_show_releases(){$("#manualSearchShowTable:has(tbody tr)").tablesorter({widgets:["zebra","filter"],textExtraction:function(){return{0(e){return $(e).attr("title")}}}(),headers:function(){return{3:{sorter:"quality"},4:{sorter:"metric"},7:{sorter:!1,filter:!1}}}(),widgetOptions:{filter_hideFilters:!0}})},postProcess(){$("#episodeDir").fileBrowser({title:_("Select Unprocessed Episode Folder"),key:"postprocessPath"})},status(){$("#schedulerStatusTable").tablesorter({widgets:["saveSort","zebra"],textExtraction:{5(e){return $(e).data("seconds")},6(e){return $(e).data("seconds")}},headers:{5:{sorter:"digit"},6:{sorter:"digit"}}}),$("#queueStatusTable").tablesorter({widgets:["saveSort","zebra"],sortList:[[3,0],[4,0],[2,1]]})},restart(){let e=srPID,t=setTimeout(()=>{setInterval(()=>{$.post(scRoot+"/home/is-alive/",n=>{(n===void 0||n.msg!==e)&&($("#restart_message").show(),$("#shut_down_loading").hide(),$("#shut_down_success").show()),n!==void 0&&n.msg!=="nope"&&n.msg!==e&&(clearInterval(t),$("#restart_loading").hide(),$("#restart_success").show(),$("#refresh_message").show(),srPID=n.msg,e=n.msg,t=setInterval(()=>{$.post(scRoot+"/home/is-alive/",()=>{clearInterval(t),setTimeout(()=>{window.location=scRoot+"/"+scDefaultPage+"/"},3e3)},"jsonp")},1e3))},"jsonp").fail(()=>{$("#restart_message").show(),$("#shut_down_loading").hide(),$("#shut_down_success").show()})},1e3)},5e3)}},manage:{init(){$.makeEpisodeRow=function(e,t,n,s,o){let i="";return i+=' <tr class="'+$("#row_class").val()+" show-"+e+'">',i+='  <td class="tableleft" align="center"><input type="checkbox" class="'+e+'-epcheck" name="'+e+"-"+t+"x"+n+'"'+(o?" checked":"")+"></td>",i+="  <td>"+t+"x"+n+"</td>",i+='  <td class="tableright" style="width: 100%">'+s+"</td>",i+=" </tr>",i},$.makeSubtitleRow=function(e,t,n,s,o,i){let a="";if(a+='<tr class="good show-'+e+'">',a+='<td align="center"><input type="checkbox" class="'+e+'-epcheck" name="'+e+"-"+t+"x"+n+'"'+(i?" checked":"")+"></td>",a+='<td style="width: 2%;">'+t+"x"+n+"</td>",o.length>0){a+='<td style="width: 8%;">',o=o.split(",");for(const e in o)Object.prototype.hasOwnProperty.call(o,e)&&(a+='<img src="'+scRoot+"/images/subtitles/flags/"+o[e]+'.png" width="16" height="11" alt="'+o[e]+'" />&nbsp;');a+="</td>"}else a+='<td style="width: 8%;">None</td>';return a+="<td>"+s+"</td>",a+="</tr>",a}},index(){$(".resetsorting").on("click",()=>{$("table").trigger("filterReset")}),$("#massUpdateTable:has(tbody tr)").tablesorter({sortList:[[1,0]],textExtraction:{2(e){return($(e).find("img").attr("alt")||"unknown").toLowerCase()},3(e){return $(e).find("span").attr("title").toLowerCase()},4(e){return $(e).find("span").attr("title").toLowerCase()},5(e){return $(e).find("span").attr("title").toLowerCase()},6(e){return $(e).find("span").attr("title").toLowerCase()},7(e){return $(e).find("span").attr("title").toLowerCase()},8(e){return $(e).find("span").attr("title").toLowerCase()},9(e){return $(e).find("span").attr("title").toLowerCase()},10(e){return $(e).text().toLowerCase()},11(e){return $(e).text().toLowerCase()}},widgets:["zebra","filter","columnSelector"],headers:{0:{sorter:!1,filter:!1},1:{sorter:"loadingNames"},2:{sorter:"network"},3:{sorter:"quality"},4:{sorter:"sports"},5:{sorter:"scene"},6:{sorter:"anime"},7:{sorter:"flatfold"},8:{sorter:"paused"},9:{sorter:"subtitle"},10:{sorter:"default_ep_status"},11:{sorter:"status"},12:{sorter:!1},13:{sorter:!1},14:{sorter:!1},15:{sorter:!1},16:{sorter:!1},17:{sorter:!1}},widgetOptions:{columnSelector_mediaquery:!1}}),$("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",()=>{$.tablesorter.columnSelector.attachTo($("#massUpdateTable"),"#popover-target")}),$(".submitMassEdit").on("click",()=>{const e=[];if($(".editCheck").each(function(){this.checked===!0&&e.push($(this).attr("id").split("-")[1])}),e.length===0)return;const t=$("<form method='post' action='"+scRoot+"/manage/massEdit'><input type='hidden' name='toEdit' value='"+e.join("|")+"'/></form>");t.appendTo("body"),t.submit()}),$(".submitMassUpdate").on("click",()=>{const e=[],t=[],n=[],s=[],o=[],i=[],a=[];$(".updateCheck").each(function(){this.checked===!0&&e.push($(this).attr("id").split("-")[1])}),$(".refreshCheck").each(function(){this.checked===!0&&t.push($(this).attr("id").split("-")[1])}),$(".renameCheck").each(function(){this.checked===!0&&n.push($(this).attr("id").split("-")[1])}),$(".subtitleCheck").each(function(){this.checked===!0&&s.push($(this).attr("id").split("-")[1])}),$(".removeCheck").each(function(){this.checked===!0&&i.push($(this).attr("id").split("-")[1])});let r=0;if($(".deleteCheck").each(function(){this.checked===!0&&r++}),r>=1&&$.confirm({title:"Delete Shows",text:"You have selected to delete "+r+" show(s).  Are you sure you wish to continue? All files will be removed from your system.",confirmButton:"Yes",cancelButton:"Cancel",dialogClass:"modal-dialog",post:!1,confirm(){if($(".deleteCheck").each(function(){this.checked===!0&&o.push($(this).attr("id").split("-")[1])}),e.length+t.length+n.length+s.length+o.length+i.length+a.length===0)return!1;const r=scRoot+"/manage/massUpdate",c="toUpdate="+e.join("|")+"&toRefresh="+t.join("|")+"&toRename="+n.join("|")+"&toSubtitle="+s.join("|")+"&toDelete="+o.join("|")+"&toRemove="+i.join("|")+"&toMetadata="+a.join("|");$.post(r,c,()=>{location.reload(!0)})}}),e.length+t.length+n.length+s.length+o.length+i.length+a.length===0)return!1;const c=scRoot+"/manage/massUpdate",l="toUpdate="+e.join("|")+"&toRefresh="+t.join("|")+"&toRename="+n.join("|")+"&toSubtitle="+s.join("|")+"&toDelete="+o.join("|")+"&toRemove="+i.join("|")+"&toMetadata="+a.join("|");$.post(c,l,()=>{location.reload(!0)})});for(const t of[".editCheck",".updateCheck",".refreshCheck",".renameCheck",".deleteCheck",".removeCheck"]){let e=null;$(t).on("click",function(n){if(!e||!n.shiftKey){e=this;return}const o=this;let s=0;$(t).each(function(){if(s===2)return!1;s===1&&!this.disabled&&(this.checked=e.checked),(this===o||this===e)&&s++})})}},backlogOverview(){$("#pickShow").on("change",e=>{const t=$(e.currentTarget).val();t&&$("html,body").animate({scrollTop:$("#show-"+t).offset().top-25},"slow")})},failedDownloads(){$("#failedTable:has(tbody tr)").tablesorter({widgets:["zebra"],sortList:[[1,0]],headers:{3:{sorter:!1}}}),$("#limit").on("change",e=>{window.location.href=scRoot+"/manage/failedDownloads/?limit="+$(e.currentTarget).val()}),$("#submitMassRemove").on("click",()=>{const e=[];if($(".removeCheck").each(function(){this.checked===!0&&e.push($(this).attr("id").split("-")[1])}),e.length===0)return!1;$.post(scRoot+"/manage/failedDownloads","toRemove="+e.join("|"),()=>{location.reload(!0)})}),$(".removeCheck").length>0&&$(".removeCheck").each(e=>{let t=null;$(e).on("click",function(n){if(!t||!n.shiftKey){t=this;return}const o=this;let s=0;$(e+":visible").each(function(){if(s===2)return!1;s===1&&(this.checked=t.checked),(this===o||this===t)&&s++})})})},massEdit(){function e(e){const t=e.split("_");return t[t.length-1]}function t(e,t){$("#new_root_dir_"+t.whichId).val(e),$("#new_root_dir_"+t.whichId).change()}$(".new_root_dir").on("change",function(){const t=e($(this).attr("id"));$("#display_new_root_dir_"+t).html("<b>"+$(this).val()+"</b>")}),$(".edit_root_dir").on("click",function(){const n=e($(this).attr("id")),s=$("#new_root_dir_"+n).val();$(this).nFileBrowser(t,{initialDir:s,whichId:n})}),$(".delete_root_dir").on("click",function(){const t=e($(this).attr("id"));$("#new_root_dir_"+t).val(null),$("#display_new_root_dir_"+t).html("<b>"+_("DELETED")+"</b>")}),SICKCHILL.common.QualityChooser.init()},episodeStatuses(){$(".allCheck").on("click",function(){const e=$(this).attr("id").split("-")[1];$("."+e+"-epcheck").prop("checked",$(this).is(":checked"))}),$(".get_more_eps").on("click",function(){const e=$(this).attr("id"),n=$("#allCheck-"+e).is(":checked"),s=$("tr#"+e),o=$(this).attr("data-clicked"),t=$(this).attr("value");o?t.toLowerCase()==="collapse"?($(".show-"+e).hide(),$(this).prop("value","Expand")):t.toLowerCase()==="expand"&&($(".show-"+e).show(),$(this).prop("value","Collapse")):($.getJSON(scRoot+"/manage/showEpisodeStatuses",{indexer_id:e,whichStatus:$("#oldStatus").val()},t=>{$.each(t,(t,o)=>{$.each(o,(o,i)=>{s.after($.makeEpisodeRow(e,t,o,i,n))})})}),$(this).attr("data-clicked",1),$(this).prop("value","Collapse"))}),$(".selectAllShows").on("click",()=>{$(".allCheck").each(function(){this.checked=!0}),$('input[class*="-epcheck"]').each(function(){this.checked=!0})}),$(".deselectAllShows").on("click",()=>{$(".allCheck").each(function(){this.checked=!1}),$('input[class*="-epcheck"]').each(function(){this.checked=!1})})},subtitleMissed(){$(".allCheck").on("click",function(){const e=$(this).attr("id").split("-")[1];$("."+e+"-epcheck").prop("checked",$(this).is(":checked"))}),$(".get_more_eps").on("click",function(){const e=$(this).attr("id"),n=$("#allCheck-"+e).is(":checked"),s=$("tr#"+e),o=$(this).attr("data-clicked"),t=$(this).attr("value");o?t==="Collapse"?($(".show-"+e).hide(),$(this).prop("value","Expand")):t==="Expand"&&($(".show-"+e).show(),$(this).prop("value","Collapse")):($.getJSON(scRoot+"/manage/showSubtitleMissed",{indexer_id:e,whichSubs:$("#selectSubLang").val()},t=>{$.each(t,(t,o)=>{$.each(o,(o,i)=>{s.after($.makeSubtitleRow(e,t,o,i.name,i.subtitles,n))})})}),$(this).attr("data-clicked",1),$(this).prop("value","Collapse"))}),$(".selectAllShows").on("click",()=>{$(".allCheck").each(function(){this.checked=!0}),$('input[class*="-epcheck"]').each(function(){this.checked=!0})}),$(".deselectAllShows").on("click",()=>{$(".allCheck").each(function(){this.checked=!1}),$('input[class*="-epcheck"]').each(function(){this.checked=!1})})}},history:{init(){},index(){$("#historyTable:has(tbody tr)").tablesorter({widgets:["zebra","filter"],sortList:[[0,1]],textExtraction:function(){if(isMeta("settings.HISTORY_LAYOUT",["detailed"]))return{0(e){return $(e).find("time").attr("datetime")},4(e){return $(e).find("span").text().toLowerCase()}};const e={0(e){return $(e).find("time").attr("datetime")},2(e){return $(e).attr("provider").toLowerCase()}};return isMeta("settings.USE_SUBTITLES",["True"])?(e[4]=function(e){return $(e).find("img").attr("title")},e[5]=function(e){return $(e).find("span").text().toLowerCase()}):e[4]=function(e){return $(e).find("span").text().toLowerCase()},e}(),headers:function(){return isMeta("settings.HISTORY_LAYOUT",["detailed"])?{0:{sorter:"realISODate"},1:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:!1,filter:!1}}:isMeta("settings.USE_SUBTITLES",["True"])?{0:{sorter:"realISODate"},1:{sorter:"loadingNames"},4:{sorter:!1},5:{sorter:"quality"},6:{sorter:!1,filter:!1}}:{0:{sorter:"realISODate"},1:{sorter:"loadingNames"},4:{sorter:"quality"},5:{sorter:!1,filter:!1}}}()}),$("#layout").on("change",function(){window.location.href=$(this).find("option:selected").val()}),$("#history_limit").on("change",function(){window.location.href=scRoot+"/history/?limit="+$(this).val()}),$("a.removehistory").on("click",()=>{const t=[];let e=0;return $(".removeCheck").each(function(){this.checked===!0&&(t.push(shiftReturn($(this).attr("id").split("-"))),e++)}),!(e<1)&&($.confirm({title:"Remove Logs",text:"You have selected to remove "+e+" download history log(s).<br /><br />This cannot be undone.<br />Are you sure you wish to continue?",confirmButton:"Yes",cancelButton:"Cancel",dialogClass:"modal-dialog",post:!1,confirm(){const e=scRoot+"/history/removeHistory",n="toRemove="+t.join("|");$.post(e,n,()=>{location.reload(!0)})}}),!1)});for(const t of[".removeCheck"]){let e=null;$(t).on("click",function(n){if(!e||!n.shiftKey){e=this;return}const o=this;let s=0;$(t).each(function(){if(s===1&&!this.disabled)this.checked=e.checked;else if(s===2)return!1;(this===o||this===e)&&s++})})}}},errorlogs:{init(){},index(){},viewlogs(){$("#min_level,#log_filter,#log_search").on("keyup change",__.debounce(()=>{$("#log_search").val().length>0&&($('#log_filter option[value="<NONE>"]').prop("selected",!0),$("#min_level option[value=5]").prop("selected",!0)),$("#min_level").prop("disabled",!0),$("#log_filter").prop("disabled",!0),document.body.style.cursor="wait";const e=scRoot+"/errorlogs/viewlog/",t="min_level="+$("select[name=min_level]").val()+"&log_filter="+$("select[name=log_filter]").val()+"&log_search="+$("#log_search").val();$.post(e,t,t=>{history.pushState("data","",e),$("pre").html($(t).find("pre").html()),$("#min_level").prop("disabled",!1),$("#log_filter").prop("disabled",!1),document.body.style.cursor="default"})},500));function e(){if($("#log_update_toggle").data("state")==="active"){const e="min_level="+$("select[name=min_level]").val()+"&log_filter="+$("select[name=log_filter]").val()+"&log_search="+$("#log_search").val(),t=scRoot+"/errorlogs/viewlog/";$.post(t,e,e=>{$("pre").html($(e).find("pre").html())})}setTimeout(e,500)}e(),$("#log_update_toggle").on("click",function(){const e=$(this).data("state")==="active";return $(this).data("state",e?"paused":"active"),$(this).find("i").toggleClass("fa-pause fa-play"),$(this).find("span").text(_(e?"Resume":"Pause")),$(this).attr("title",_(e?"Resume updating the log on this page.":"Pause updating the log on this page.")),!1})}},schedule:{init(){$(".btn-cal-subscribe").attr("href",document.location.href.replace(/https?/,"webcal").replace(/schedule.*/,"calendar"))},index(){if(isMeta("settings.COMING_EPS_LAYOUT",["list"])){const e={date:0,show:2,network:5},t=getMeta("settings.COMING_EPS_SORT"),n=t in e?[[e[t],0]]:[[0,0]];$(".resetsorting").on("click",()=>{$("#showListTable").trigger("filterReset")}),$("#showListTable:has(tbody tr)").tablesorter({widgets:["stickyHeaders","filter","columnSelector","saveSort"],sortList:n,textExtraction:{0(e){return $(e).find("time").attr("datetime")},1(e){return $(e).find("time").attr("datetime")},2(e){return latinize($(e).text().normalize("NFC"))},7(e){return $(e).find("span").text().toLowerCase()}},headers:{0:{sorter:"realISODate"},1:{sorter:"realISODate"},2:{sorter:"loadingNames"},4:{sorter:"loadingNames"},7:{sorter:"quality"},8:{sorter:!1},9:{sorter:!1}},widgetOptions:{filter_columnFilters:!0,filter_hideFilters:!0,filter_saveFilters:!1,columnSelector_mediaquery:!1,stickyHeaders_offset:50}}),$(document).ajaxEpSearch()}isMeta("settings.COMING_EPS_LAYOUT",["banner","poster"])&&($(document).ajaxEpSearch(),$(".ep_summary").hide(),$(".ep_summaryTrigger").on("click",function(){$(this).next(".ep_summary").slideToggle("normal",function(){$(this).prev(".ep_summaryTrigger").attr("src",function(e,t){return $(this).next(".ep_summary").is(":visible")?t.replace("plus","minus"):t.replace("minus","plus")})})})),$("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",()=>{$.tablesorter.columnSelector.attachTo($("#showListTable"),"#popover-target")}),$("#sort, #viewpaused, #viewsnatched, #layout").on("change",function(){window.location.href=$(this).find("option:selected").val()})}},addShows:{init(){$("#tabs").tabs({collapsible:!0,selected:metaToBool("settings.SORT_ARTICLE")?-1:0}),$.initRemoteShowGrid=function(){$("#showsort").val("original"),$("#showsortdirection").val("asc"),$("#showsort").on("change",function(){let e;switch(this.value){case"original":{e="original-order";break}case"rating":{$("#container").isotope({sortBy:"random"}),e="rating";break}case"rating_votes":{e=["rating","votes"];break}case"votes":{e="votes";break}case"rank":{e="rank";break}default:{e="name";break}}$("#container").isotope({layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},sortBy:e})}),$("#showsortdirection").on("change",function(){$("#container").isotope({layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},sortAscending:this.value==="asc"})}),$("#container").isotope({sortBy:"original-order",layoutMode:"masonry",masonry:{isFitWidth:!0,horizontalOrder:!0},getSortData:{name(e){const t=$(e).attr("data-name")||"",n=new RegExp("^((?:"+getMeta("settings.GRAMMAR_ARTICLES")+")\\s)","i");return(metaToBool("settings.SORT_ARTICLE")?t:t.replace(n,"")).toLowerCase()},rating:"[data-rating] parseInt",votes:"[data-votes] parseInt",rank:"[data-rank] parseInt"}})},$.loadTraktImages=function(){const t=scRoot+"/addShows/getTrendingShowImage";let e=0;$("img.trakt-image").each(function(){const n=$(this).attr("data-src-indexer-id");n?(setTimeout(()=>{$.post(t,{indexerId:n},e=>{e&&$('img.trakt-image[data-src-indexer-id="'+e+'"]').attr("src",$('img.trakt-image[data-src-indexer-id="'+e+'"]').attr("data-src-cache"))})},300+300*e),e++):$(this).attr("src",$(this).attr("data-src-cache"))})},$.fn.loadRemoteShows=function(e,t,n){$(this).html('<img id="searchingAnim" src="'+scRoot+"/images/loading32"+themeSpinner+'.gif" height="32" width="32" />&nbsp;'+t),$(this).load(scRoot+e+" #container",function(e,t){t==="error"?$(this).empty().html(n):($.initRemoteShowGrid(),$.loadTraktImages())})},$("#saveDefaultsButton").on("click",function(){const e=[],t=[];$("#anyQualities option:selected").each((t,n)=>{e.push($(n).val())}),$("#bestQualities option:selected").each((e,n)=>{t.push($(n).val())}),generateBlackWhiteList(),$.post(scRoot+"/config/general/saveAddShowDefaults",{defaultStatus:$("#statusSelect").val(),anyQualities:e.join(","),bestQualities:t.join(","),defaultSeasonFolders:$("#season_folders").is(":checked"),subtitles:$("#subtitles").is(":checked"),anime:$("#anime").is(":checked"),scene:$("#scene").is(":checked"),defaultStatusAfter:$("#statusSelectAfter").val(),whitelist:$("#whitelist").val(),blacklist:$("#blacklist").val()}),$(this).attr("disabled",!0)}),$("#statusSelect, #qualityPreset, #season_folders, #anyQualities, #bestQualities, #subtitles, #scene, #anime, #statusSelectAfter, #white, #black").on("change",()=>{$("#saveDefaultsButton").attr("disabled",!1)}),SICKCHILL.common.QualityChooser.init()},index(){},newShow(){const e=function(){const e={showName:"",dir:"unknown dir.",sepChar:""};if($("input:radio[name=whichSeries]:checked").length>0?e.showName=$("input:radio[name=whichSeries]:checked").val().split("|")[4]:$("input:hidden[name=whichSeries]").length>0&&$("input:hidden[name=whichSeries]").val().length>0&&(e.showName=$("#providedName").val()),SICKCHILL.common.updateBlackWhiteList(e.showName),$("#rootDirs option:selected").length>0?(e.dir=$("#rootDirs option:selected").val(),e.dir.includes("/")?e.sepChar="/":e.dir.includes("\\")&&(e.sepChar="\\"),e.dir.trim(e.sepChar),e.dir+=e.sepChar):$("#fullShowPath").val()&&(e.dir=$("#fullShowPath").val()),e.showName.length>0?$.post(scRoot+"/addShows/sanitizeFileName",{name:e.showName},t=>{$("#desc-show-name").text(e.showName),e.dir===$("#fullShowPath").val()?$("#desc-directory-name").html(e.dir):$("#desc-directory-name").html(e.dir+t+e.sepChar)}):($("#desc-show-name").text(e.showName),$("#desc-directory-name").html(e.dir)),$("#desc-quality-name").text($("#qualityPreset option:selected").text()),!$("input:radio[name=whichSeries]:checked").val()&&!$("input:hidden[name=whichSeries]").val())return $("#addShowButton").attr("disabled",!0);if(!$("#rootDirs option:selected").val()&&!$("#fullShowPath").val())return $("#addShowButton").attr("disabled",!0);$("#addShowButton").attr("disabled",!1)},n=function(){$("#blackwhitelist").toggle($("#anime").prop("checked"))},s=function(e){let t='<div class="row"><div class="col-lg-6 col-md-12"><table class="sickchillTable new-show-table tablesorter"><thead><tr><th></th><th>Show Name</th><th>Premiere</th><th>Indexer</th></tr></thead><tbody>';const n=e.indexOf(e=>!e.inShowList);for(const[o,s]of e.entries())t+='<tr class="'+(s.inShowList?"in-list":"")+'"><td><input type="radio" class="whichSeries" name="whichSeries" value="'+s.obj+'" '+(n===o?"checked ":"")+(s.inShowList?"disabled":"")+"/></td><td>"+function(){let e="<a href=";return e+=s.inShowList?'"/home/displayShow?show='+s.id+'"':'"'+s.url+'" target="_blank"',e+=">"+s.title+"</a>",e}()+"</td><td>"+s.debut+"</td><td>"+s.indexer+"</td></tr>";return t+="</tbody></table></div></div>",t};let t=null;const o=function(){if(t&&t.abort(),!$("#show-name").val())return;const n=_($("#show-name").val().trim()+" on "+$("#providedIndexer option:selected").text()+" in "+$("#indexerLangSelect option:selected").text());$("#searchResults").empty().html('<img id="searchingAnim" src="'+scRoot+"/images/loading32"+themeSpinner+'.gif" height="32" width="32" /> '+_("searching {searchingFor}...").replace(/{searchingFor}/,n)),t=$.ajax({url:scRoot+"/addShows/searchIndexersForShowName",data:{search_term:$("#show-name").val().trim(),exact:$("#exact-match").is(":checked")?1:0,lang:$("#indexerLangSelect").val(),indexer:$("#providedIndexer").val()},timeout:Number.parseInt($("#indexer_timeout").val(),10)*1e3,dataType:"json",error(){$("#searchResults").empty().html(_("search timed out, try again or try another indexer")),$(".next-steps").hide()},success(t){let n='<legend class="legendStep">#2 Pick a Show</legend>';if(t.results.length===0)n+="<b>No results found, try a different search.</b>",$(".next-steps").hide();else{const e=[];$.each(t.results,(n,s)=>{const i=s.join("|").replace(/"/g,""),o={obj:i,indexer:s[0],id:s[3],title:s[4],debut:s[5],inShowList:s[6],url:anonURL+s[2]+s[3]};t.langid&&(o.url+="&lid="+t.langid),e.push(o)}),n+=s(e),$(".next-steps").show()}$("#searchResults").html(n),e(),$(".new-show-table").tablesorter({widgets:["stickyHeaders","zebra","saveSort"],headers:{0:{sorter:!1}}})}})};$("#search-button").on("click",o),$("#addShowButton").on("click",()=>{if(!$('input:radio[name="whichSeries"]:checked').val())return notifyModal("You must choose a show to continue"),!1;generateBlackWhiteList(),$("#addShowForm").submit()}),$("#anime").on("click",()=>{n(),e()}),$("#skipShowButton").on("click",()=>{$("#skipShow").val("1"),$("#addShowForm").submit()}),$("#rootDirText").change(e),$("#qualityPreset").change(e),$("#searchResults").on("change",".whichSeries",e),$("#show-name").on("focus keyup",e=>{e.keyCode===13&&$("#search-button").click()}),$("#show-name").val()&&$("#search-button").click(),e(),n()},addExistingShow(){$("#tableDiv").on("click","#checkAll",function(){const e=this.checked;$(".dirCheck").each(function(){this.checked=e})}),$("#submitShowDirs").on("click",()=>{const e=$("#addShowForm");let t=!1;if($(".dirCheck").each(function(){if(this.checked===!0){const n=$(this).attr("id"),s=$(this).closest("tr").find("select").val();$("<input>",{type:"hidden",name:"shows_to_add",value:s+"|"+n}).appendTo(e),t=!0}}),t===!1)return!1;$("<input>",{type:"hidden",name:"promptForSettings",value:$("#promptForSettings").is(":checked")?"on":"off"}).appendTo(e),e.submit()});function e(){let e="";$(".dir_check").each((t,n)=>{$(n).is(":checked")&&(e.length>0&&(e+="&"),e+="rootDir="+encodeURIComponent($(n).attr("id")))}),$("#tableDiv").html('<img id="searchingAnim" src="'+scRoot+'/images/loading32.gif" height="32" width="32" /> '+_("loading folders...")),$.post(scRoot+"/addShows/massAddTable/",e,e=>{$("#tableDiv").html(e),$("#addRootDirTable").tablesorter({widgets:["zebra"],headers:{0:{sorter:!1}}})})}let t="";const n=function(){if(t===$("#rootDirText").val())return!1;t=$("#rootDirText").val(),$("#rootDirStaticList").html(""),$("#rootDirs option").each((e,t)=>{$("#rootDirStaticList").append('<li class="ui-state-default ui-corner-all"><input type="checkbox" class="cb dir_check" id="'+$(t).val()+'" checked=checked> <label for="'+$(t).val()+'">'+$(t).val()+"</label></li>")}),e()};n(),$("#rootDirText").on("change",n),$("#rootDirStaticList").on("click",".dir_check",e),$("#tableDiv").on("click",".showManage",e=>{e.preventDefault(),$("#tabs").tabs("option","active",0),$("html,body").animate({scrollTop:0},1e3)})},recommendedShows(){$("#recommendedShows").loadRemoteShows("/addShows/getRecommendedShows/","Loading recommended shows...","Trakt timed out, refresh page to try again")},trendingShows(){$("#trendingShows").loadRemoteShows("/addShows/getTrendingShows/?traktList="+$("#traktList").val(),"Loading trending shows...","Trakt timed out, refresh page to try again"),$("#traktlistselection").on("change",e=>{const t=e.target.value;window.history.replaceState({},document.title,"?traktList="+t),$("#trendingShows").loadRemoteShows("/addShows/getTrendingShows/?traktList="+t,"Loading trending shows...","Trakt timed out, refresh page to try again")})},popularShows(){$.initRemoteShowGrid()}},movies:{init(){$("#movieTabs").tabs({activate(){$(".movie-grid").isotope("layout")}})},index(){$(".resetsorting").on("click",()=>{$("table").trigger("filterReset")}),$("#filterMovieName").on("input",__.debounce(()=>{$(".movie-grid").isotope({filter(){const e=$(this).find(".movie-title").html().trim().toLowerCase();return e.includes($("#filterShowName").val().toLowerCase())}})},500));function t(e){let t=0,o=0,n=0,s=0;e<125?(n=3,s=4):e<175?(t=9,o=40,n=4,s=5):(t=11,o=50,n=6,s=6),$("#posterPopup").remove(),t===void 0?$(".movie-details").hide():($(".movie-details").show(),$(".movie-dlstats, .movie-quality").css("fontSize",t),$(".movie-network-image").css("width",o)),$(".movie-container").css({width:e,borderWidth:s,borderRadius:n})}let e;typeof Storage!="undefined"&&(e=Number.parseInt(localStorage.getItem("posterSize"),10)),(typeof e!="number"||Number.isNaN(e))&&(e=188),t(e),$("#posterSizeSlider").slider({min:75,max:250,value:e,change(e,n){typeof Storage!="undefined"&&localStorage.setItem("posterSize",n.value),t(n.value),$(".movie-grid").isotope("layout")}}),$("#rootDirSelect").on("change",()=>{$("#rootDirForm").submit()}),$(".progressbar").each(function(){const e=$(this).data("progress-percentage"),t=Math.max(20,e-e%20);$(this).progressbar({value:e}),$(this).data("progress-text")&&$(this).append('<div class="progressbarText" title="'+$(this).data("progress-tip")+'">'+$(this).data("progress-text")+"</div>"),$(this).find(".ui-progressbar-value").addClass("progress-"+t)}),$("img#network").on("error",function(){$(this).parent().text($(this).attr("alt")),$(this).remove()})},details(){$(".addQTip").each(function(){$(this).css({cursor:"help","text-shadow":"0px 0px 0.5px #666"}),$(this).qtip({show:{solo:!0},position:{viewport:$(window),my:"left center",adjust:{y:-10,x:2}},style:{tip:{corner:!0,method:"polygon"},classes:"qtip-rounded qtip-shadow ui-tooltip-sb"}})}),$.fn.generateStars=function(){return this.each((e,t)=>{$(t).html($("<span/>").width($(t).text()*12))})},$(".imdbstars").generateStars(),$("#popover").popover({placement:"bottom",html:!0,content:'<div id="popover-target"></div>'}).on("shown.bs.popover",()=>{$(".displayShowTable").each((e,t)=>{$.tablesorter.columnSelector.attachTo(t,"#popover-target")})})}}},UTIL={exec(e,t){const n=SICKCHILL;t=t===void 0?"init":t,e!==""&&n[e]&&typeof n[e][t]=="function"&&n[e][t]()},init(){const e=document.body,t=e.dataset.controller,n=e.dataset.action;UTIL.exec("common"),UTIL.exec(t),UTIL.exec(t,n)}};$.getJSON(scRoot+"/ui/locale.json",{lang:getMeta("settings.GUI_LANG")},e=>{window.gt=e===void 0?new Gettext:new Gettext(e.messages),window._=function(e){return gt.gettext(e)},window._n=function(e,t,n){return gt.ngettext(e,t,n)},navigator.userAgent.includes("PhantomJS")||$(document).ready(UTIL.init)})